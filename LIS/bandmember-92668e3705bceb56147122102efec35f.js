window.Showography&&$.extend(Showography,{domReady:function(){const e=$.proxy(Showography,"domReady");return function(t){e(),t?Showography.fetchLatest():this.addRefreshLink()}}(),fetchLatest:function(e){const t=this,a=e?"/refresh_upcoming_shows_cb":"/get_upcoming_shows_cb";$.ajax(a,{type:"POST",data:{},dataType:"json",success:function(e){if(e&&e.length>0){const a=$("#showography").empty().get(0);$(a).toggle(!0),Templ.renderElem(a,"_show_list",{shows_list:e}),t.refreshPeekaboo(),t.addRefreshLink()}},failure:function(e){Log.info("showography callback failure: ",e),$("#showography .showLatest").text(TM("Oops!","dev"))}})},addRefreshLink:function(){const e=this;$("#showography .title").append('<span class="showLatest"><a href="#">refresh</a></span>').find(".showLatest a").on("click",(function(){return e.fetchLatest(!0),$(this).parent().empty().text(TM("refreshing…","dev")),!1}))}});var Color={isDark:function(e){const t=this.hex2rgb(e);return this.rgb2hsl(t)[2]<.5},lowContrast:function(e,t,a){let n,i;return void 0===a&&(a=3),this.luminance(t)>this.luminance(e)?(n=this.luminance(t),i=this.luminance(e)):(n=this.luminance(e),i=this.luminance(t)),ratio=(n+.05)/(i+.05),ratio<a},luminance:function(e){const t=this.hex2rgb(e);let a,n,i;for(let e=0;e<t.length;e++)t[e]<=.03928?t[e]=t[e]/12.92:t[e]=Math.pow((t[e]+.055)/1.055,2.4);return a=t[0],n=t[1],i=t[2],.2126*a+.7152*n+.0722*i},rgb2hex:function(e){const t=Math.round(255*e[0]),a=Math.round(255*e[1]),n=Math.round(255*e[2]);return(t<16?"0":"")+t.toString(16)+(a<16?"0":"")+a.toString(16)+(n<16?"0":"")+n.toString(16)},hex2rgb:function(e){return 6==(e=e.replace(/^#/,"")).length?[parseInt("0x"+e.substring(0,2))/255,parseInt("0x"+e.substring(2,4))/255,parseInt("0x"+e.substring(4,6))/255]:3==e.length?[parseInt("0x"+e.substring(0,1))/15,parseInt("0x"+e.substring(1,2))/15,parseInt("0x"+e.substring(2,3))/15]:void 0},hsl2rgb:function(e){let t,a;const n=e[0],i=e[1],o=e[2];a=o<=.5?o*(i+1):o+i-o*i,t=2*o-a;const s=function(e,t,a){return 6*(a=a<0?a+1:a>1?a-1:a)<1?e+(t-e)*a*6:2*a<1?t:3*a<2?e+(t-e)*(.66666-a)*6:e};return[s(t,a,n+.33333),s(t,a,n),s(t,a,n-.33333)]},rgb2hsl:function(e){let t,a,n,i,o,s;const r=e[0],l=e[1],d=e[2];return t=Math.min(r,Math.min(l,d)),a=Math.max(r,Math.max(l,d)),n=a-t,s=(t+a)/2,o=0,s>0&&s<1&&(o=n/(s<.5?2*s:2-2*s)),i=0,n>0&&(a==r&&a!=l&&(i+=(l-d)/n),a==l&&a!=d&&(i+=2+(d-r)/n),a==d&&a!=r&&(i+=4+(r-l)/n),i/=6),[i,o,s]}};window.Design=(()=>{"use strict";let e=$("#custom-design-rules-style").data("design");const t=Object.assign({},e);let a;e&&(e.bg_file_url=ImageUtils.imageURL(e.bg_image_id,130,!0),Object.keys(e).forEach((t=>{t.endsWith("_color")&&"#"!==e[t].slice(0,1)&&(e[t]="#".concat(e[t]))})));const n={roots:"#p-tralbum-page.responsive-layout",map:{bg_color:"--desktop-background-color",body_color:"--desktop-body-color",hd_ft_color:"--desktop-header-color",link_color:"--desktop-link-color",navbar_bg_color:"--desktop-nav-bar-color",secondary_text_color:"--desktop-secondary-text-color",text_color:"--desktop-text-color",bg_attachment:"--desktop-background-attachment",bg_halign:"--desktop-background-position-x",bg_valign:"--desktop-background-position-y",bg_image:"--desktop-background-image",bg_repeat:"--desktop-background-repeat",bg_size:"--desktop-background-size"},set:(e,t)=>{document.querySelectorAll(n.roots).forEach((a=>{a.style.setProperty(n.map[e],t)}))}};function i(e,i){t[e]=i,a||n.set(e,i)}return{lastFocusedField:null,editDesign:n=>{a=!!n,Stats.record({kind:"click",click:"menubar_edit_design"});const i=$.extend({},e,{navbar_visible:$("#band-navbar").length>0}),o=()=>{const n=$.farbtastic("#picker",(e=>{$(Design.lastFocusedField).val(e).closest(".colorSwatch").css("border-color",e).end().trigger("select").triggerHandler("colorchanged",e)}));$("#editDesign input.hexInput").focus((function(){Design.lastFocusedField=this,n.setColor(Design.maybePrependHash(this.value))})).textInput((function(){const e=this.value,t=Design.maybePrependHash(e);7===t.length&&(n.setColor(t),$(this).triggerHandler("colorchanged",t))})),elt("bodyColor").blur(),Dom.focus("bodyColor"),$("body").triggerHandler("editingDesign"),$("#bodyColor").on("colorchanged",((e,t)=>{t="#"+Design.normalizeHex(t),$("#bodyColor").val(t),Design.setBodyColor(t),a&&($("#pgBd").css("background-color",t),$(".label-band-selector .bands-menu").css("background-color",t),$("button.subtop, button.subbot").css("color",t),$(".buyFullDiscography .art-thumb.empty").css("background-color",t),$(".editable-grid.editable .no-art .artists-grid-pic").css("background-color",t),$("ol.sub-navbar > li.active").css("background-color",t)),$("#trackInfo .g-button:not(.send-as-gift), #merch-item .g-button:not(.send-as-gift)").css("color",t),$("#merch-item .send-as-gift, #trackInfo .send-as-gift").css("border-color",Design.invertIconographyTest()?"rgba(255, 255, 255, 0.32)":"rgba(34, 34, 34, 0.32)"),Design.updateBodyClasses(t),Design.updateIconography(Design.invertIconographyTest()),Design.updatePgBdBorder()})),$("#bgColor").on("colorchanged",((e,t)=>{t="#"+Design.normalizeHex(t),$("#bgColor").val(t),Design.setBackgroundColor(t),Design.updateHdFtColor(t),Design.updatePgBdBorder(),Design.updateBodyClasses(t)})),$("#linkColor").on("colorchanged",((e,t)=>{Design.setSkinnableLinksColor(t)})),$("#textColor").on("colorchanged",((e,t)=>{Design.setPrimaryTextColor(t)})),$("#secondaryTextColor").on("colorchanged",((e,t)=>{Design.setSetSecondaryTextColor(t)})),$("#navbarBgColor").on("colorchanged",((e,t)=>{Design.setNavbarColor(t)})),$("#editDesign .colorSwatch").click((function(){$(this).find("input.hexInput").focus()})),"f"===e.bg_behavior?$("#repeat-behavior-items").css("visibility","hidden"):$("#repeat-behavior-items").css("visibility","visible"),t.bg_file_url=e.bg_file_url,Design.updatePgBdBorder()};NuDialog.showTemplate("_edit_design",i,{title:TM("Edit Design","dev"),buttons:[{text:TM("OK","dev"),click:function(){Design.saveDesign()&&$(this).dialog("close")}},{text:TM("Cancel","dev"),click:function(){Design.onCancelDialog(),$(this).dialog("close")}}],open:function(){o(),Design.attachEvents()},close:function(){$(this).find("form").remove(),Design.lastFocusedField=null,$(this).dialog("destroy")},dialogClass:"edit-design-dialog no-overlay",width:"530px"})},invertIconographyTest:()=>Color.isDark(elt("bodyColor").value),updateIconography:e=>{e?document.body.classList.add("invertIconography"):document.body.classList.remove("invertIconography")},updateBodyClasses:e=>{"#FFFFFF"===e.toUpperCase()?(document.body.classList.remove("blackbody"),document.body.classList.add("whitebody")):"#000000"===e.toUpperCase()?(document.body.classList.remove("whitebody"),document.body.classList.add("blackbody")):(document.body.classList.remove("whitebody"),document.body.classList.remove("blackbody"))},setBodyColor:e=>{i("body_color",e),a&&($("#pgBd").css("background-color",e),$(".label-band-selector .bands-menu").css("background-color",e),$("button.subtop, button.subbot").css("color",e),$(".buyFullDiscography .art-thumb.empty").css("background-color",e),$(".editable-grid.editable .no-art .artists-grid-pic").css("background-color",e),$("ol.sub-navbar > li.active").css("background-color",e))},setBackgroundColor:e=>{i("bg_color",e),a&&$(document.body).css("background-color",e)},updateHdFtColor:e=>{const t=Color.rgb2hsl(Color.hex2rgb(e)),n=t[2]>.5;t[1]/=2,t[2]=t[2]+(n?-.25:.1);const o="#".concat(Color.rgb2hex(Color.hsl2rgb(t)));i("hd_ft_color",o),a&&$("#pgHd").css("background-color",o)},setSetSecondaryTextColor:e=>{i("secondary_text_color",e),a&&($(".secondaryText").css("color",e),$(".label-band-selector .tabs > li").css("border-color",e))},setNavbarColor:e=>{i("navbar_bg_color",e),a&&$("#band-navbar").css("background-color",e)},setPrimaryTextColor:e=>{i("text_color",e),a&&($("#pgBd").css("color",e),$(".primaryText").css("color",e),$(".label-band-selector a.selected, button.vid").css("color",e),$(".label-band-selector .selected .caret").css("fill",e),$("#band-navbar .primaryText").css("border-color",e),$("button.vid .iconplay").css("border-left-color",e),$(".label-welcome a.existing, .label-welcome h2, .label-welcome p").css("color",e),$(".label-welcome a.existing").css("box-shadow","2px 2px ".concat(e)))},setSkinnableLinksColor:e=>{if(i("link_color",e),a){$("a.custom-color").css("color",e),$("#rightColumn, #tagArea, #trackInfo, #name-section, #indexpage, .editable-grid, #band-navbar, #live-ticket-item, #merch-item p, #merch-item .buy, #merch-item .more-merch, .share-collect-controls, .collected-by, .video-list, .sub .main, .sub .subhead, .subwelcome, .label-welcome, .label-band-selector").find("a, button").not(".notSkinnable,#discography a.primaryText,#trackInfo a.title_link, .includeditems a, .sub button, .selected, .existing, .order_package_link.g-button, .download-link.g-button, .g-button.subscribe-link").css("color",e),$(".label-band-selector .caret").not(".selected .caret").css("fill",e),$(".label-welcome a.new").css("box-shadow","2px 2px ".concat(e)),$(".featured-grid-name").css("color",e),$("#subscribe").find("button.subtop, button.subbot").css("background-color",e);const t=Color.hex2rgb(e),a="rgba(".concat(255*t[0],", ").concat(255*t[1],", ").concat(255*t[2],", 0.2)");$("#subscribe").find("ul.tierslist li.tier").css("border-color",a),$("#subscribe").find(".whatyouget button.post-message-link").css("background-color",a).css("color",e),$(".post-subscribe .button-background").css("background-color",a).css("color",e),$(".post-subscribe").find(".band-link-color, .message-text a").css("color",e),$("ol.sub-navbar").find("li:not(.active) a, .band-link-color").css("color",e),$("#follow-unfollow,.ellipsis-bg,.ellipsis-text").find("div").not(".notSkinnable").css("color",e),$("#trackInfo .g-button:not(.send-as-gift), #merch-item .g-button:not(.send-as-gift)").css("background-color",e).css("border-color",e),$("#trackInfo .send-as-gift, #merch-item .send-as-gift").css("color",e)}},normalizeHex:e=>e&&e.toUpperCase().replace(/^#?/,"").substring(0,6),rbgStringToHex:e=>{if("#"===e.charAt(0))return e;const t=e.indexOf("("),a=e.indexOf(")"),n=e.substring(t+1,a).split(",");for(let e=0;e<n.length;e++)n[e]=parseInt(n[e])/255;return Color.rgb2hex(n)},maybePrependHash:e=>6===e.length&&"#"!==e.charAt(0)?"#".concat(e):e,bgSizeValue:e=>"f"===e.bg_behavior?"cover":"auto",bgAttachmentValue:e=>e.bg_fixed||"f"===e.bg_behavior?"fixed":"scroll",saveDesign:()=>{let e=!1;if($("#editDesign .hexInput").each((function(){const t=elt("".concat(this.id,"_alert"));FormUtils.showHideAlert(t,null),-1===this.value.search(/^#?[0-9A-F]{6,6}$/i)&&(FormUtils.showHideAlert(t,"invalid color value"),e=!0)})),e)return!1;const a={crumb:gCrumb,body_color:Design.normalizeHex(t.body_color),bg_color:Design.normalizeHex(t.bg_color),link_color:Design.normalizeHex(t.link_color),text_color:Design.normalizeHex(t.text_color),secondary_text_color:Design.normalizeHex(t.secondary_text_color),hd_ft_color:Design.normalizeHex(t.hd_ft_color),invert_iconography:Design.invertIconographyTest(),bg_image_id:t.bg_image_id,bg_image_sig:t.bg_image_sig,bg_fixed:$("#bg-fixed:checked").val(),bg_behavior:$("#bg-behavior").val()};if($("#bg-image-filename").length){const e=$("#bg-hrepeat:checked").val(),t=$("#bg-vrepeat:checked").val();a.bg_file_name=$("#bg-image-filename").text();const n=Design.bgRepeatDualToSingle(e,t);n&&(a.tile_bg=n),a.bg_halign=$("#bg-halign").val()}$("#band-navbar").length>0&&(a.navbar_bg_color=Design.normalizeHex($("#navbarBgColor").val()));const n=Design.currentDesignValues();return Crumb.ajax({type:"POST",url:"/save_design",data:Url.joinQuery(a),dataType:"json",success:()=>Design.saveDesignSucceeded(n),error:Design.saveDesignFailed}),Design.insertRules(a),!0},currentDesignValues:()=>Object.assign(t,{invert_iconography:Design.invertIconographyTest(),tile_bg:Design.bgRepeatDualToSingle($("#bg-hrepeat:checked").val(),$("#bg-vrepeat:checked").val()),bg_halign:$("#bg-halign").val(),bg_file_name:$("#bg-image-filename").text(),bg_behavior:$("#bg-behavior").val(),bg_fixed:$("#bg-fixed:checked").val()}),saveDesignSucceeded:t=>{e=t,U.pagedataBlob().subscribe&&window.location.reload()},saveDesignFailed:()=>{NuDialog.alert(TM("Error","dev"),TM("Sorry, there was a problem saving your design settings. Please try again.","dev"))},insertRules:e=>{const t=["a.custom-color { color: #".concat(e.link_color,"; }"),".themed .label-band-selector a.themeable { color: #".concat(e.link_color,"; }"),".themed .label-band-selector .caret { fill: #".concat(e.link_color,"; }"),".themed .label-band-selector a.selected { color: #".concat(e.text_color,"; }"),".themed .label-band-selector .selected .caret { fill: #".concat(e.text_color,"; }")],a="&shy;<style>".concat(t.join(""),"</style>");$("<div class='dynamic-design-rule' />").html(a).appendTo("body"),$(".label-band-selector a").css("color",""),$(".label-band-selector .caret").css("fill","")},bgPositionValue:(t,a)=>{let n,i;switch(t.bg_halign){case"c":n="center";break;case"r":n="right";break;default:n="left"}a?(i=e.bg_fixed||"f"===e.bg_behavior,"f"===e.bg_behavior&&(n="center")):i=$("#bg-fixed:checked").val()||"f"===$("#bg-behavior").val();let o=0;return $("body").hasClass("has-menubar")&&!i&&(o+=53),$("body").hasClass("has-top-banner")&&!i&&(o+=40),{horizontal:n,vertical:"".concat(o,"px"),value:"".concat(n," ").concat(o,"px")}},bgRepeatChanged:()=>{const e=$("#bg-hrepeat:checked").val(),t=$("#bg-vrepeat:checked").val(),n={tile_bg:Design.bgRepeatDualToSingle(e,t)},o=Design.bgRepeatValue(n);i("bg_repeat",o),a&&$("body").css("background-repeat",o)},bgAlignChanged:()=>{const e={bg_halign:$("#bg-halign").val()},t=Design.bgPositionValue(e);i("bg_halign",t.horizontal),i("bg_valign",t.vertical),a&&$("body").css("background-position",t.value)},bgBehaviorChanged:()=>{if("f"===$("#bg-behavior").val()){const e="cover",t="fixed",n={bg_halign:"c"},o=Design.bgPositionValue(n);i("bg_size",e),i("bg_attachment",t),i("bg_halign",o.horizontal),i("bg_valign",o.vertical),$("#repeat-behavior-items").css("visibility","hidden"),a&&($("body").css("background-size",e),$("body").css("background-attachment",t),$("body").css("background-position",o.value))}else{const e={bg_halign:$("#bg-halign").val()},t=Design.bgPositionValue(e),n="auto";i("bg_size",n),i("bg_halign",t.horizontal),i("bg_valign",t.vertical),$("#repeat-behavior-items").css("visibility","visible"),a&&($("body").css("background-size",n),$("body").css("background-position",t.value)),$("#bg-fixed:checked").val()||$("body").css("background-attachment","scroll"),"center"!==$("#bg-halign").val()&&Design.bgAlignChanged()}},bgFixedToggled:()=>{const e=$("#bg-fixed:checked").val()?"fixed":"scroll";i("bg_attachment",e),a&&$("body").css("background-attachment",e);const t={bg_halign:$("#bg-halign").val()},n=Design.bgPositionValue(t);i("bg_halign",n.horizontal),i("bg_valign",n.vertical),a&&$("body").css("background-position",n.value)},bgRepeatDualToSingle:(e,t)=>e&&t?1:e?2:t?3:null,bgRepeatValue:e=>{switch(e.tile_bg){case 1:return"repeat";case 2:return"repeat-x";case 3:return"repeat-y";default:return"no-repeat"}},deleteBackgroundImage:()=>{t.bg_image_id=null,t.bg_image_url=null,Design.updatePgBdBorder(),i("bg_image","none"),a&&$("body").css("background-image","none"),Templ.renderElem("bgImageControlsWrapper","_bg_image_upload",{bg_image_id:null}),Design.attachEvents()},DEFAULTS:{bodyColor:"#FFFFFF",bgColor:"#F8F8F8",linkColor:"#0687F5",textColor:"#363636",secondaryTextColor:"#888888",navbarBgColor:"#F2F2F2"},restoreDefaultColors:()=>{const e=Design.DEFAULTS;elt("bodyColor").value=e.bodyColor,elt("bgColor").value=e.bgColor,elt("linkColor").value=e.linkColor,elt("textColor").value=e.textColor,elt("secondaryTextColor").value=e.secondaryTextColor,$("#navbarBgColor").val(e.navbarBgColor),Design.updatePgBdBorder(),$("#editDesign .hexInput").each((function(){$(this).triggerHandler("colorchanged",Design.maybePrependHash(this.value)),$(this).parent().css("border-color",this.value)})),Dom.focus(Design.lastFocusedField)},updatePgBdBorder:()=>{Design.togglePageBorderClass(elt("bgColor").value,elt("bodyColor").value)},togglePageBorderClass:(e,a)=>{const n=e.toLowerCase()===Design.DEFAULTS.bgColor.toLowerCase(),i=a.toLowerCase()===Design.DEFAULTS.bodyColor.toLowerCase();t.defaultbg=!t.bg_image_id&&n,t.defaultbg&&i?document.body.classList.add("pgBd-border"):document.body.classList.remove("pgBd-border")},onCancelDialog:()=>{a&&(elt("pgBd").style.backgroundColor=e.body_color,elt("pgBd").style.color=e.text_color,$("button.subtop, button.subbot").css("color",e.body_color),$("#band-navbar").css("background-color",e.navbar_bg_color),$("#pgHd, #pgFt").css("background-color",e.hd_ft_color),$("ol.sub-navbar > li.active").css("background-color",e.body_color)),Design.setSkinnableLinksColor(e.link_color),Design.setPrimaryTextColor(e.text_color),Design.setSetSecondaryTextColor(e.secondary_text_color),Design.setBodyColor(e.body_color),Design.setBackgroundColor(e.bg_color),Design.updateHdFtColor(e.hd_ft_color),Design.setNavbarColor(e.navbar_bg_color);let i="none";e.bg_file_url&&(i=e.bg_file_url.startsWith("url")?e.bg_file_url:"url(".concat(e.bg_file_url,")")),Design.updateIconography(e.invert_iconography),Design.updateBodyClasses(e.body_color);const o=Design.bgRepeatValue(e),s=Design.bgPositionValue(e,!0),r=Design.bgAttachmentValue(e),l=Design.bgSizeValue(e);a&&$("body").css({"background-color":e.bg_color,"background-image":i,"background-repeat":o,"background-position":s.value,"background-attachment":r,"background-size":l}),Object.keys(e).forEach((i=>{t[i]=e[i],a||n.set(i,e[i])})),t.bg_image_id=e.bg_image_id,Design.togglePageBorderClass(e.bg_color,e.body_color),$(".label-band-selector a").css("color",""),$(".label-band-selector .caret").css("fill","")},uploadBackgroundImage:n=>{const o={targetURL:"/bg_image_uploaded",container:"background-image-container",maxSize:2097152};n&&(o.file=n,o.errorHandler=e=>{Log.error("upload error: ",e),Design.setImageError(e.errorMessage)}),window.uploadImage(o,(n=>{if(!n)return;const o="url(".concat(n.bgImageURL,")"),s="repeat",r=Design.bgPositionValue({bg_halign:"l"}),l="scroll",d="auto";i("bg_color",e.bg_color),i("bg_image",o),i("bg_repeat",s),i("bg_attachment",l),i("bg_size",d),i("bg_halign",r.horizontal),i("bg_valign",r.vertical),a&&$("body").css({"background-image":o,"background-repeat":s,"background-position":r.value,"background-attachment":l,"background-size":d}),Log.debug("upload complete: ",n),Templ.renderElem("bgImageControlsWrapper","_bg_image_upload",{bg_file_name:n.bgImageFilename,bg_image_id:n.bgImageID,tile_bg:1,bg_halign:"l"}),t.bg_image_id=n.bgImageID,t.bg_image_url=n.bgImageURL,t.bg_image_sig=n.bgImageSig,Design.updatePgBdBorder(),Design.attachEvents()}))},setImageError:e=>{UploadImageErrors.doDialog(TM("Background Image Upload Error","dev"),e)},attachEvents:()=>{$("#design-bg-image-upload-button").wrapFileInput({select:e=>{Design.uploadBackgroundImage(e[0])},accept:"image/*"}),$("#editDesign .restore-default-colors").click(Design.restoreDefaultColors.bind(Design)),$("#bg-image-delete").click(Design.deleteBackgroundImage.bind(Design)),$("#bg-behavior").change(Design.bgBehaviorChanged.bind(Design)),$("#bg-hrepeat, #bg-vrepeat").change(Design.bgRepeatChanged.bind(Design)),$("#bg-halign").change(Design.bgAlignChanged.bind(Design)),$("#bg-fixed").change(Design.bgFixedToggled.bind(Design))}}})();var CustomHeader={upload:function(){"use strict";uploadImage({targetURL:"/custom_header_uploaded",container:"customHeaderBlank",maxSize:2097152},(function(e){e&&(CustomHeader.render(e.customHeaderURL,e.area_tags),e.area_tags&&e.area_tags.length&&NuDialog.alert(TM("Existing Image Map","dev"),TM("You have an existing image map that will be applied to this header. You can edit or delete the image map from your Profile page.","dev")))}))},remove:function(){"use strict";let e,t;e=elt("_bc_customheader_map"),t=e?"<p>"+TM("Your image map will be retained and applied to the next header you upload. To edit or delete your image map, visit your Profile page.","dev")+"</p>":"";NuDialog.alertHTML(TM("Delete Custom Header","dev"),"<p>"+TM("Are you sure you want to delete your custom header?","dev")+"</p>"+t,{buttons:[{text:TM("OK"),click:function(){Crumb.ajax({type:"POST",url:"/delete_custom_header",dataType:"json"}),CustomHeader.render(null,null),$(this).dialog("close")}},{text:TM("Cancel"),click:function(){$(this).dialog("close")}}]})},render:function(e,t){"use strict";$("#customHeader,#customHeaderBlank").remove();const a=Templ.render("_custom_header",{customHeaderURL:e,member_of_current_band:!0,area_tags:t,standard_page:!0,is_label:Identities.pageBand.isLabel()});$("#customHeaderWrapper").prepend(a),CustomHeader.attachEvents()},attachEvents:function(){"use strict";this.pagedata||(this.pagedate=$("#pagedata").data("blob"),this.cfg=this.pagedate&&this.pagedate.cfg?this.pagedate.cfg:null),$.support.upload&&this.cfg&&this.cfg.no_flash_uploads?$("#customHeaderBlank button.upload").wrapFileInput({select:function(e){CustomHeader.uploadImage({targetURL:"/custom_header_uploaded",maxSize:2097152},e[0])},accept:"image/*"}):$("#customHeaderBlank button.upload").click(CustomHeader.uploadImage),$("#customHeader button.remove").click(CustomHeader.remove)},uploadImage:function(e,t){"use strict";const a={targetURL:"/custom_header_uploaded",container:"customHeaderBlank",maxSize:2097152};e&&(a.file=t,a.errorHandler=function(e){CustomHeader.setImageError(e.errorMessage)}),window.uploadImage(a,(function(e){e&&(CustomHeader.render(e.customHeaderURL,e.area_tags),e.area_tags&&e.area_tags.length&&NuDialog.alert(TM("Existing Image Map","dev"),TM("You have an existing image map that will be applied to this header. You can edit or delete the image map from your Profile page.","dev")))}))},setImageError:function(e){"use strict";UploadImageErrors.doDialog("Custom Header Upload Error",e)}};$(document).ready(CustomHeader.attachEvents),function(e){"use strict";var t,a;const n=null!==(t=document.currentScript.dataset)&&void 0!==t&&t.deleteTralbum?JSON.parse(null===(a=document.currentScript.dataset)||void 0===a?void 0:a.deleteTralbum):null,i={showErrorAlert:function(e){const t="<p>"+TM("Sorry, we couldn’t delete your {{item}} for some reason! Please try again.","dev",{item:e})+"</p><p>"+TM("If the problem persists, please send an email describing your problem to <a {{link}}>support@bandcamp.com</a>.","dev",{link:'href="mailto:support@bandcamp.com"'})+"</p>";NuDialog.alertHTML(TM("Delete Error","dev"),t)},deleteTrack:function(t,a,o){let s,r;const l=n.num_collectors>0,d="undefined"!=typeof buyFullDiscographyVM&&buyFullDiscographyVM.tralbums&&3===buyFullDiscographyVM.tralbums.length&&buyFullDiscographyVM.tralbumInBuyFullDiscography(TralbumData.id);function c(){const t=$.showMask(),n=new URLSearchParams(document.location.search);Crumb.ajax({type:"POST",url:"/delete_track_cb",data:{id:a,svdfns_trlbm_ignored:l?"svdfns_trlbm_ignored":"",takedown_reason:o,source_type:n.get("source_type"),source_id:n.get("source_id"),ground:n.get("ground")},dataType:"json",success:function(a){a.redirect_url?e.location.href=a.redirect_url:(t.remove(),i.showErrorAlert("track"))},error:function(e,a,n){Log.info("delete_track callback failure: status: "+e.status+"; statusText: "+n),t.remove(),i.showErrorAlert("track")}})}if(TralbumData.last_subscription_item)NuDialog.alert(TM("Delete Track","dev"),TM("Sorry, you can’t delete this track. You have an active subscription and this is the last back-catalog item. If you must delete this track, please deactivate your subscription and/or add another track to your subscription before you delete this one.","dev"));else if(l){s=TP("Are you sure you want to permanently delete this track? You will also remove this track from 1 fan collection page. This will be upsetting to the fan whose page is affected, and also means you’ll no longer benefit from the promotion that fan’s page gives you.","Are you sure you want to permanently delete this track? You will also remove this track from {{count}} fan collection pages. This will be upsetting to the fans whose pages are affected, and also means you’ll no longer benefit from the promotion those fans’ pages give you.",n.num_collectors,"dev"),d&&(s+=" ",s+=TM("Deleting this release will also disable the Full Digital Discography option. You need at least three public releases, albums or tracks, to offer your full discography.","dev")),s+=" ",s+=TM("Are you sure you want to proceed?","dev");const e={num_collectors:n.num_collectors,num_collectors_with_photos:n.num_collectors_with_photos,suppress_message:!0,custom_message:s,max_shown:40};1===n.num_collectors&&(e.dlg_title=TM("Delete track","dev")),SaveTheFans.show_dialog(c,null,e)}else{const e=TM("Delete track?","dev");s=TM("Are you sure you want to permanently delete this track?","dev"),d&&(s+="<br><br>",s+=TM("Deleting this release will disable the Full Digital Discography option. You need at least three public releases, albums or tracks, to offer your full discography.","dev")),r=i.buttons(c),NuDialog.alertHTML(e,s,{buttons:r,dialogClass:"wide-button"})}},deleteAlbum:function(t,a,o){const s=TralbumData.trackinfo?TralbumData.trackinfo.length:0,r=parseInt(TralbumData.preorder_count,10)||0,l=(TralbumData.licensed_version_ids||[]).length;let d,c;const u=0===r&&n.num_collectors>0,b="undefined"!=typeof buyFullDiscographyVM&&buyFullDiscographyVM.tralbums&&3===buyFullDiscographyVM.tralbums.length&&buyFullDiscographyVM.tralbumInBuyFullDiscography(TralbumData.id);function m(){const t=$.showMask(),n=new URLSearchParams(document.location.search);Crumb.ajax({type:"POST",url:"/delete_album_cb",data:{id:a,svdfns_trlbm_ignored:u?"svdfns_trlbm_ignored":"",takedown_reason:o,source_type:n.get("source_type"),source_id:n.get("source_id"),ground:n.get("ground")},dataType:"json",success:function(a){a.redirect_url?e.location.href=a.redirect_url:(t.remove(),i.showErrorAlert("album"))},error:function(e,a,n){Log.info("delete_album callback failure: status: "+e.status+"; statusText: "+n),t.remove(),i.showErrorAlert("album")}})}if(TralbumData.last_subscription_item)NuDialog.alert(TM("Delete Album","dev"),TM("Sorry, you can’t delete this album. You have an active subscription and this is the last back-catalog item. If you must delete this album, please deactivate your subscription and/or add another album to your subscription before you delete this one.","dev"));else if(u){d=1===s?TP("You are about to permanently delete this album. The one track on this album will be deleted as well. You will also remove this album from 1 fan collection page. This will be upsetting to the fan whose page is affected, and also means you’ll no longer benefit from the promotion that fan’s page gives you.","You are about to permanently delete this album. The one track on this album will be deleted as well. You will also remove this album from {{count}} fan collection pages. This will be upsetting to the fans whose pages are affected, and also means you’ll no longer benefit from the promotion those fans’ pages give you.",n.num_collectors,"dev"):TP("You are about to permanently delete this album. All tracks on this album will be deleted as well. You will also remove this album from 1 fan collection page. This will be upsetting to the fan whose page is affected, and also means you’ll no longer benefit from the promotion that fan’s page gives you.","You are about to permanently delete this album. All tracks on this album will be deleted as well. You will also remove this album from {{count}} fan collection pages. This will be upsetting to the fans whose pages are affected, and also means you’ll no longer benefit from the promotion those fans’ pages give you.",n.num_collectors,"dev"),b&&(d+=" ",d+=TM("Deleting this release will also disable the Full Digital Discography option. You need at least three public releases, albums or tracks, to offer your full discography.","dev")),d+=" ",d+=TM("Are you sure you want to proceed?","dev");const e={num_collectors:n.num_collectors,num_collectors_with_photos:n.num_collectors_with_photos,suppress_message:!0,totally_destructive:!0,custom_message:d,max_shown:70};1===n.num_collectors&&(e.dlg_title=TM("Delete album","dev")),SaveTheFans.show_dialog(m,null,e)}else{const e=TM("Delete album?","dev");c=i.buttons(m,s),r<=0?d=TM("Are you sure you want to permanently delete this album?","dev"):(d="<strong class='bad'>"+TM("Are you sure you want to delete this album, which has open pre-orders?","dev")+"</strong>",d+="<br><br>",d+=TP("The 1 fan who pre-ordered this album will not receive a link to complete their download, nor any direct notice from Bandcamp. Also, these previously-recorded sales will not be reported to any music charts.","The {{count}} fans who pre-ordered this album will not receive a link to complete their download, nor any direct notice from Bandcamp. Also, these previously-recorded sales will not be reported to any music charts.",r,"dev")),l&&(d+=" ",d+=TP("We’ll notify 1 licensee via email.","We’ll notify your {{count}} licensees via email.",l,"dev")),b&&(d+="<br><br>",d+=TM("Deleting this release will disable the Full Digital Discography option. You need at least three public releases, albums or tracks, to offer your full discography.","dev")),s>0&&(d+="<br><br>",d+="<strong class='bad'>"+TP("The one track on this album will be deleted as well.","All {{count}} tracks on this album will be deleted as well.",s,"dev")+"</strong>",d+="<br><br>",d+="<strong>"+TM("This action cannot be undone.","dev")+"</strong>"),NuDialog.alertHTML(e,d,{buttons:c,width:"34em",dialogClass:"wide-button"})}},buttons:function(e,t){let a;a=t?TP("Yes, delete this album and its track","Yes, delete this album and its tracks",t,"dev"):TM("Yes, delete it","dev");const n=[];return n.push({text:a,click:function(){e(),$(this).dialog("close")},"data-test":"confirm-delete-button"}),n.push({text:TM("No, keep it","dev"),click:function(){$(this).dialog("close")},"data-test":"cancel-delete-button"}),n}};e.DeleteTralbum=i,$(document).ready((function(){$("#editDeleteCommands").css("visibility","visible"),$(".tralbum-delete-button").click((function(){return"track"===TralbumData.current.type?i.deleteTrack(null,TralbumData.current.id,null):i.deleteAlbum(null,TralbumData.current.id,null),!1}))}))}(window),function(e,t){let a=e.Merch;a||(a=e.Merch={}),a.deleteItem=function(t){if(!confirm(TM("Are you sure you want to delete this item?","dev")))return;let n={id:t};if(Identities&&Identities.isAdmin()){const t=new URLSearchParams(e.location.search);n.source_type=t.get("source_type"),n.source_id=t.get("source_id"),n.ground=t.get("ground")}Crumb.ajax({type:"POST",url:"/merch_delete",data:n,dataType:"json",success:function(t){Trackpipe.showXHRError(t)?Log.error("XHR POST returned error JSON",t):(a.notifyOtherPages("merch-updated"),e.location="/merch")},error:function(e,t,a){Log.error("XHR POST failed",e,t,a),e.data?Trackpipe.showXHRError(e.data):NuDialog.alert(TM("Network Error","dev"),TM("There was a network error while saving. Please try again.","dev"))}})},a.editorCommChannels=[];const n=t("#pagedata").data("blob"),i=n&&n.reduced_editor?n.licensee_data:null;if(i){const e=i.id;a.editorCommChannels.push(new Cookie.CommChannel(e+"editor"))}else if(Identities&&Identities.pageBand&&Identities.pageBand.id){const e=Identities.pageBand.id;a.editorCommChannels.push(new Cookie.CommChannel(e+"editor"))}a.notifyOtherPages=function(e,n){t.each(a.editorCommChannels,(function(t,a){a.send(e,n)}))}}(window,jQuery),function(e){"use strict";function t(){const t=e(this);if(t.children("li").length<=1)return;t.sortable({handle:".drag-thumb",tolerance:"pointer",revert:250,opacity:.75,placeholder:"placeholder",start:function(){Log.debug("grid reordering"),i&&(clearTimeout(i),i=null);o&&(o.abort(),o=null);e(".crowdfunding-campaign",t).each((function(){const t=e(this);t.data("pos",t.index())}))},stop:function(){if(!n)return;Log.debug("Delaying grid order save"),s(!0),i=setTimeout((function(){i=null;const a=[];t.children("li").each((function(){e(this).data("item-id")&&a.push(e(this).data("item-id"))})),Log.note("Saving grid order",a);const r=t.data("edit-callback"),l=t.data("edit-data-as"),d=t.data("edit-ids-arg")||"ids",c=e("#pagedata").data("blob").api_params||{};if(c[d]=a,!r)throw alert(TM("Failed to save grid order.","dev")),s(!1),new Error("error: no grid edit callback");Log.note("to custom endoint "+r),o=Crumb.ajax({type:"POST",url:r,data:c,dataType:"json",dataAs:l,success:function(e){Log.debug("Saved grid order",e),n=!1,s(!1)},error:function(e,t,a){"abort"!==t&&(Log.error("Failed reorder",e,t,a),alert(TM("Failed to save grid order.","dev")),s(!1))},complete:function(){o=null}})}),a)},update:function(){Log.debug("grid order changed"),n=!0},cancel:".crowdfunding-campaign",change:function(){const a=e(".crowdfunding-campaign",t).detach(),n=e('<li style="display:none;"></li>').prependTo(t);a.each((function(){const a=e(this),n=a.data("pos");a.insertAfter(e("li",t).eq(n))})),n.remove()}}).children("li:not(:has(.drag-thumb))").bcGridDragThumb();const a=3e3;let n,i,o;function s(t){e(window).off("beforeunload.grid_editor"),t?(e(window).on("beforeunload.grid_editor",(function(){return TM("Please wait until your new grid order is saved.","dev")})),StatusSpinny.show("fast",!0,TM("Saving new grid order…","dev"))):StatusSpinny.hide("fast")}}e(document).ready((function(){e("ol.editable-grid.editable").each(t)})),e.fn.bcGridDragThumb=function(){return this.append('<div class="drag-thumb"><div class="bc-ui"></div></div>')}}(jQuery);var LabelUtils={};!function(e,t){"use strict";t.showServerErrors=function(t,a){if(t.ok)return!1;let n=!1;return t.errors||(n=!0,Log.warn("result.ok is false but no result.errors")),Iter.each(t.errors||[],(function(t){const i=a[t.field];i&&e.isWriteableObservable(i.error_key)&&t.reason?i.error_key(t.reason):n=!0})),n&&NuDialog.alert(TM("Error","dev"),t.error_message||TM("Unknown error occurred.","dev")),!0};let a=null,n=null;t.geocode=function(e,t){e.subscribe((function(e){n&&(clearTimeout(n),n=null),a&&(a.abort(),a=null),(e=$.trim(e))?n=setTimeout((function(){a=$.post("/geo2_cb",{location:e},(function(e){a=null,t(e.text)}))}),500):t(null)}))}}(ko,LabelUtils);var BandItemsPickerVM=function(){"use strict";return function(t){const a=this;t=$.extend({defaultSelected:!1,busyObservable:ko.observable(),items:[]},t||{}),this.updateItems=function(n,i){void 0===i&&(i=t.defaultSelected),a.items(Iter.collect(n||[],(function(a){return new e(a,i,t.busyObservable)})))},this.items=ko.observableArray(),this.updateItems(t.items,t.defaultSelected),this.enabledItems=ko.computed((function(){return Iter.findAll(a.items(),(function(e){return e.selectable()}))})),this.sortedItems=ko.computed((function(){const e=a.items().slice();return e.sort((function(e,t){return e.displayTitle.toLocaleLowerCase().localeCompare(t.displayTitle.toLocaleLowerCase())})),e})),this.selectedItems=ko.computed((function(){return Iter.findAll(a.items(),(function(e){return e.selectable()&&e.selected()}))})),this.unselectedItems=ko.computed((function(){return Iter.findAll(a.items(),(function(e){return e.selectable()&&!e.selected()}))})),this.paramValue=ko.computed((function(){return Iter.collect(a.selectedItems(),(function(e){return e.toHash()}))}))};function e(e,t,a){const n=this;this.toHash=function(){return{item_type:e.item_type,item_id:e.item_id}},this.artId=e.art_id,this.displayTitle=e.package_album_title?e.package_album_title+" - "+e.title:e.title,e.label_owner_name&&(this.displayTitle=TM("{{album_title}} (owned by {{label_name}})","dev",{album_title:this.displayTitle,label_name:e.label_owner_name})),this.selectable=ko.computed((function(){return!e.label_owner_name})),this.enabled=ko.computed((function(){return!a()&&n.selectable()})),this.selected=ko.observable(this.selectable()&&t)}}();!function(e){"use strict";function t(){const t=this;this.slots={one:new a(t,e("li.feature-one")),two:new a(t,e("li.feature-two"))},this.empty=ko.computed((function(){return t.slots.one.empty()&&t.slots.two.empty()})),this.show=ko.computed((function(){return!t.empty()})),this.nextFreeSlot=function(e){return t.slots.one.empty()?t.slots.one:t.slots.two.empty()&&e?t.slots.two:null},this.rearrangeSlots=function(a){if("phone"!=MediaView.mode){if(t.empty())return void e(".featured-grid").animate({height:0},400);!t.slots.one.empty()&&t.slots.two.empty()?e(".featured-grid").animate({height:"470px"},300):e(".featured-grid").removeAttr("style")}t.slots.one.empty()&&(t.slots.one.artistInfo(t.slots.two.artistInfo()),e(t.slots.one.element).find(".art").fadeIn(a),t.slots.two.artistInfo(null)),t.slots.two.empty()?(e("ol.featured-grid").addClass("one"),e("li.feature-one").hide(0,(function(){t.slots.one.solo(!0),e(t.slots.one.element).find(".art").fadeIn(a)})).fadeIn(a)):(e("ol.featured-grid").removeClass("one"),e("li.feature-one").hide(0,(function(){t.slots.one.solo(!1),e(t.slots.two.element).find(".art").fadeIn(a)})).fadeIn(a))},this.downgradeFeatured=function(){t.slots.two.artistInfo()&&t.slots.two.moveBackToArtistsGrid()},this.removeArtist=function(e){t.empty()||(t.slots.one.artistInfo().id==e.id?t.slots.one.artistInfo(null):t.slots.two.empty()||t.slots.two.artistInfo().id!=e.id||t.slots.two.artistInfo(null),t.rearrangeSlots(300))}}function a(t,a){const n=this;this.element=a,this.artistInfo=ko.observable(),this.solo=ko.observable(!1),this.featured=ko.computed((function(){return!n.artistInfo()||n.artistInfo().featured()})),this.name=ko.computed((function(){return n.artistInfo()?n.artistInfo().name():null})),this.artistUrl=ko.computed((function(){return n.artistInfo()?n.artistInfo().data.to_artist_url:null})),this.imageType=ko.computed((function(){return n.solo()?"bio_featured":"package_feature"})),this.imageUrl=ko.computed((function(){if(n.artistInfo()){if(n.artistInfo().imageId())return ImageUtils.imageURL(n.artistInfo().imageId(),n.imageType());if(n.artistInfo().data.photo)return ImageUtils.imageURL(n.artistInfo().data.photo,n.imageType())}return null})),this.secondaryText=ko.computed((function(){return n.artistInfo()?n.artistInfo().data.pretty_location:null})),this.empty=ko.computed((function(){return!n.artistInfo()||"undefined"===n.artistInfo()})),this.authed=ko.computed((function(){return!!n.artistInfo()&&n.artistInfo().authed})),this.transferRequest=ko.computed((function(){return!!n.artistInfo()&&n.artistInfo().transferRequest()})),this.moveBackToArtistsGrid=function(){const a=n.artistInfo();n.artistInfo(null),t.rearrangeSlots(300);const i=e(a.gridVM.element),o=e(a.container);o.removeClass("featured"),a.featured(!1),i.prepend(o),e(a.container).fadeIn(300,(function(){(i.find("li:visible")&&i.find("li:visible").length)>8&&(i.removeClass("columns-2"),i.addClass("columns-3"))}))},this.removeFromFeatured=function(){Crumb.ajax({type:"POST",dataAs:"JSON",url:"/api/label/1/remove_feature_item",data:{user_id:Identities.user().id,band_id:Identities.pageBand.id,item_type:"a",item_id:n.artistInfo().id},success:function(i){i.error?NuDialog.alert(TM("Error","dev"),i.error_message):e(a).find(".art").fadeOut(300,(function(){t.slots.two.empty()?e(".featured-grid").animate({height:0},300,(function(){n.moveBackToArtistsGrid()})):n.moveBackToArtistsGrid()}))},error:NuDialog.showNetworkError})},this.removeFromLabel=function(){n.artistInfo().remove(),n.artistInfo()&&"undefined"!=n.artistInfo()||(n.artistInfo(null),t.rearrangeSlots(300))},this.hide=function(){s("hide",{member_band_id:n.artistInfo().id},(function(e){NuDialog.showAPIError(e)||(n.artistInfo().isHidden(!0),n.moveBackToArtistsGrid())}))}}function n(t,a){const n=this;this.element=t;const o=t.data("initial-values");function r(){const t=[];Iter.each(n.gridItems(),(function(e){("i"===e.state()||e.transferRequest())&&t.push(e.id)})),0!==t.length&&s("poll_member_band_state",{member_band_ids:t},(function(t){t.member_band_state&&Iter.each(t.member_band_state,(function(t){const a=n.memberBandsById()[t.band_id];if(a){a.state()!==t.state&&(a.state(t.state),function(t){let a;switch(t.state()){case"a":a=TM("Congratulations! {{band_name}} has accepted your invitation and is now linked to your account.","dev",{band_name:"<em>"+Text.escapeHtml(t.name())+"</em>"});break;case"d":a=TM("{{band_name}} has been removed from your account.","dev",{band_name:"<em>"+Text.escapeHtml(t.name())+"</em>"})}a&&e(".artists-grid").before('<div class="artists-grid-banner">'+a+"</div>")}(a),"d"===t.state&&n.removeArtist(a))}}))})).always((function(){setTimeout(r,3e4)}))}this.name=o.label_name,this.gridItems=ko.observableArray(Iter.collect(o.bands,(function(e){return new i(e,n,t.find('[data-item-id="'+e.id+'"]'))}))),this.publicGridItems=ko.computed((function(){return Iter.findAll(n.gridItems(),(function(e){return e.hasPublicItems()&&"i"!=e.state()}))})),this.memberBandsById=ko.computed((function(){const e={};return Iter.each(n.gridItems(),(function(t){e[t.id]=t})),e})),this.featuredFull=ko.computed((function(){return!a.nextFreeSlot(n.publicGridItems().length>10)})),this.setup=function(){Iter.each(n.gridItems(),(function(e){e.setupUpload()})),r()},this.removeArtist=function(e){t.find("[data-item-id="+e.id+"]").remove(),n.gridItems.remove(e),n.publicGridItems().length<11&&a.downgradeFeatured(),a.removeArtist(e),a.rearrangeSlots(300)},this.setFeaturedItem=function(t,i){const o=a.nextFreeSlot(n.publicGridItems().length>10);o&&(e("ol.featured-grid li .art").show(),o.artistInfo(t),i&&a.rearrangeSlots(300))}}function i(t,a,n){const i=this;let r;this.data=t,this.gridVM=a,this.id=t.id,this.subdomain=t.subdomain,this.name=ko.observable(t.name),this.state=ko.observable(t.state),this.authed=!!t.authed,this.transferRequest=ko.observable(t.transfer_request),this.hasPublicItems=ko.observable(t.has_public_items),this.isHidden=ko.observable(t.hidden),this.busy=!1,this.featured=ko.observable(!1),this.container=n,this.uploadButton=this.container.find("button.image-upload"),this.progressIndicator=this.container.find(".upload-progress"),this.errorMessage=ko.observable(),this.imageId=ko.observable(),this.imageHash=ko.observable(),this.imageUrl=ko.computed((function(){return i.imageId()?ImageUtils.imageURL(i.imageId(),"package_page"):null})),this.featurable=ko.computed((function(){return(t.photo||i.imageUrl())&&i.hasPublicItems()&&"i"!=i.state()&&!i.isHidden()})),this.uploaded=ko.computed((function(){return i.imageId()&&i.imageHash()})),e(this.container).on("focus","input[type='file']",(function(){e(this).closest(".html5-upload-wrapper").find(".image-upload").addClass("focus")})).on("blur","input[type='file']",(function(){e(this).closest(".html5-upload-wrapper").find(".image-upload").removeClass("focus")})),this.uninvite=function(){s("uninvite",{member_band_id:i.id},(function(e){NuDialog.showAPIError(e)||i.gridVM.removeArtist(i)}))},this.reinvite=function(){Crumb.ajax({type:"POST",url:"/api/label/1/invite",data:{user_id:Identities.user().id,band_id:Identities.pageBand.id,subdomain:i.subdomain},success:function(e){NuDialog.showAPIError(e)||(e.ok?NuDialog.alertHTML(TM("Artist Re-Invited","dev"),TM("Request sent to {{band_name}}.","dev",{band_name:"<i>"+Text.escapeHtml(i.name())+"</i>"})):e.errors&&Iter.each(e.errors,(function(e){NuDialog.alert(TM("Error","dev"),i.errorMessage[e.reason])})))},error:NuDialog.showNetworkError,dataAs:"JSON"})},this.moveToFeatured=function(){i.featured(!0),e(n).fadeOut(300,(function(){i.gridVM.setFeaturedItem(i,!0),e("body, html, .featured-grid.featured-artists").animate({scrollTop:0},"slow");const t=e(i.gridVM.element);(t.find("li:visible")&&t.find("li:visible").length)<=8&&(t.removeClass("columns-3"),t.addClass("columns-2")),i.busy=!1}))},this.addToFeatured=function(){i.busy||(i.busy=!0,Crumb.ajax({type:"POST",dataAs:"JSON",url:"/api/label/1/add_feature_item",data:{user_id:Identities.user().id,band_id:Identities.pageBand.id,member_band_id:i.id,item_type:"a",item_id:i.id},success:function(e){if(e.error){if(i.featured(!1),NuDialog.alert(TM("Error","dev"),e.error_message),e.featured_items){let t=!1;Iter.each(e.featured_items,(function(e){const n=Iter.find(a.gridItems(),(function(t){return t.id==e}));n&&(t||(n.featured(!0),a.setFeaturedItem(n,!1),a.publicGridItems().length<11&&(t=!0)))})),a.featuredGridVM.rearrangeSlots(300)}}else i.moveToFeatured()},error:function(){NuDialog.showNetworkError(),i.busy=!1}}))},this.unhide=function(){s("unhide",{member_band_id:i.id},(function(e){NuDialog.showAPIError(e)||i.isHidden(!1)}))},this.hide=function(){s("hide",{member_band_id:i.id},(function(e){NuDialog.showAPIError(e)||i.isHidden(!0)}))},this.access=function(){const e=new o(a,i,{templateName:"label/give_access",title:TM("Give User Access","dev"),apiEndpoint:"give_access",alertTitle:TM("Give User Access","dev"),alertText:TM("Success! Once this user accepts they will have access to the account of {{band_name}}","dev",{band_name:Text.escapeHtml(i.name())}),flagTransfer:!1});NuDialog.showViewModel(e)},this.remove=function(){const t="<p>"+TM("Remove {{artist}} from {{band_name}}?","dev",{artist:"<em>"+Text.escapeHtml(i.name())+"</em>",band_name:"<em>"+Text.escapeHtml(a.name)+"</em>"})+"</p>";NuDialog.alertHTML(TM("Remove artist","dev"),t,{buttons:[{text:TM("Yes, remove","dev"),click:function(){s("remove",{member_band_id:i.id},(function(e){NuDialog.showAPIError(e)||(i.featured(!1),e.transfer_ownership?function(e){const t=new o(a,i,{templateName:"label/transfer_artist",title:TM("Remove artist","dev"),apiEndpoint:"transfer",alertTitle:TM("Remove artist","dev"),alertText:TM("Email sent. When the recipient accepts the account transfer we’ll remove {{artist}} from your site.","dev",{artist:"<em>"+Text.escapeHtml(i.name())+"</em>"}),flagTransfer:!0,showBandProfileUrl:e});NuDialog.showViewModel(t)}(e.show_band_profile_url):i.gridVM.removeArtist(i))})),e(this).dialog("close")}},{class:"weak",text:TM("Cancel","dev"),click:function(){e(this).dialog("close")}}]})},this.setupUpload=function(){e.support.upload?this.uploadButton.wrapFileInput({select:e.proxy(this.doPhotoUpload,this),accept:"image/*"}).attr("tabindex","-1"):this.uploadButton.hide()},this.doPhotoUpload=function(t){i.errorMessage(null);const a={file:t[0],targetURL:"/band_photo_uploaded",container:this.container.get(0),maxSize:4194304,errorHandler:function(e){e.errorMessage?i.errorMessage(UploadImageErrors.prepErrorString(e.errorMessage)):i.errorMessage("Upload failed – please try again.")}};e(window).on("beforeunload.photoupload",(function(){if(uploadImage.uploader&&uploadImage.uploader.working())return"Please wait until your image finishes uploading."})),uploadImage(a,(function(t){r(!1),t&&t.band_bio?(i.imageId(t.band_bio.image_id),i.imageHash(t.band_bio.image_hash),i.saveBioImage(t.band_bio.image_id,t.band_bio.image_hash),e(i.container).find(".html5-upload-wrapper").remove()):e(window).off("beforeunload.photoupload")}),(function(){r(!0)}))},this.saveBioImage=function(t,a){StatusSpinny.show("fast",!0,"Saving band photo&hellip;"),Crumb.ajax({type:"POST",url:"/api/bandsettings/1/update_bio_image",data:e.extend({},e("#pagedata").data("blob").api_params,{user_id:Identities.user().id,band_id:i.id,image_id:t,image_hash:a}),success:function(t){StatusSpinny.hide(),e(window).off("beforeunload.photoupload"),t.error&&i.errorMessage("Error: "+t.error)},dataAs:"JSON"})},r=function(e){i.progressIndicator["fade"+(e?"In":"Out")]()}}function o(e,t,a){const n=this;this.templateName=function(){return a.templateName},this.dialogOptions=function(){return{dialogClass:"label-style",title:a.title,buttons:[]}},this.$dialog=ko.observable(),this.gridVM=e,this.memberBand=t,this.showProfileURL=a.showBandProfileUrl||!1,this.profileURL=siteroot_current+"/profile?id="+t.id,this.possessiveMemberBandName=ko.computed((function(){const e=t.name();let a=e+"’";return"s"!==e[e.length-1].toLowerCase()&&(a+="s"),a})),this.submitXhr=ko.observable(),this.email1=ko.observable().extend({errorKeys:{missing:TM("Please enter an email address.","dev"),invalid:TM("Please enter a valid email address","dev"),validator:function(e){if(!e)return"missing";const t=e.substring(0,100).trim();return/.+@.+/.test(t)?null:"invalid"}}}),this.email2=ko.observable(),this.emailMismatch=ko.computed((function(){return n.email1()!==n.email2()})).extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}}),this.submit=function(){if(n.email1.validate()||n.emailMismatch())return;const e={member_band_id:n.memberBand.id,email:n.email1()},i=s(a.apiEndpoint,e,(function(e){e.error&&"errEmailBadFormat"==e.error?(n.submitXhr(null),n.email1.error_key("invalid")):NuDialog.showAPIError(e)||function(e){let t;if(e.ok)return!1;e.error_key?(t=n[e.field],t&&ko.isWriteableObservable(t.error_key)&&e.field?t.error_key(e.error_key):Log.error("Unknown result.field: "+e.field+"; result.error_key: "+e.error_key)):NuDialog.alert(TM("Error","dev"),e.error_message||TM("Unknown error occurred.","dev"));return!0}(e)?n.submitXhr(null):(n.$dialog().dialog("close"),NuDialog.alertHTML(a.alertTitle,a.alertText),a.flagTransfer&&t.transferRequest(e.transfer_request))}));n.submitXhr(i)},this.cancel=function(){this.$dialog().dialog("close")}}function s(t,a,n){return Crumb.ajax({url:"/api/label/1/"+t,data:e.extend({},e("#pagedata").data("blob").api_params,a),dataAs:"JSON",type:"POST",error:function(e){n({ok:!1,error:e})},success:n})}e((function(){const a=e(".featured-grid.featured-artists")[0],i=new t;a&&ko.applyBindings(i,a),e(".artists-grid").each((function(){const t=new n(e(this),i);e(this).find(".artists-grid-item").each((function(){const a=e(this).data("item-id"),n=ko.utils.arrayFirst(t.gridItems(),(function(e){return e.id===a}));ko.applyBindings(n,this)})),e(this).removeClass("loading"),t.setup();const o=e(a).data("initial-values");let s=!1;o&&(Iter.each(o,(function(e){const a=Iter.find(t.gridItems(),(function(t){return t.id==e.id}));a&&(s||(a.featured(!0),t.setFeaturedItem(a,!1),t.publicGridItems().length<11&&(s=!0)))})),i.rearrangeSlots(0));const r=e(".artists-grid");(r.find("li:visible")&&r.find("li:visible").length)<=8&&(r.removeClass("columns-3"),r.addClass("columns-2"))})),e(".featured-thumb").click((function(e){e.preventDefault()}))})),e(".artists-grid-banner .dismiss").click((function(){let t;return e(this).closest(".artists-grid-banner").hide(),t=e(this).data("banner-name"),t&&e.post("/banner_cb",{d:t}),!1}))}(jQuery);var AddNewArtistDialog=function(e,t){"use strict";return{showDialog:function(e){const t=new a(e);NuDialog.showViewModel(t)}};function a(a){const i=this,o=e("#pagedata").data("blob").add_new_artist;a=e.extend({artistName:null,tralbums:[],successCallback:function(){window.location=Identities.pageLabel().url()+"/artists"}},a||{}),this.templateName=function(){return"label/add_new_artist"},this.templateHash=function(){return o},this.dialogOptions=function(){return{draggable:!1,dialogClass:"label-style add-artist single-button add-new-artist",width:"35em",title:a.dialogTitle?a.dialogTitle:TM("Add new artist","dev"),buttons:[]}},this.swapToExistingArtistDialog=function(){i.$dialog().dialog("close");let t={subdomain:i.subdomain()};a.existingArtistSuccessCallback&&(t=e.extend(t,{dialogTitle:TM("Add existing account and move releases","dev"),showBandItems:!1,labelItemsPickerVM:i.bandItemsPickerVM,successCallback:a.existingArtistSuccessCallback})),AddExistingArtistDialog.showDialog(t)},this.conversionFlow=a.conversion,this.$dialog=t.observable(),this.photoUploader=new n(this.$dialog),this.MAX_GENRES=o.MAX_GENRES,this.genreHints=o.genre_hints,this.artistName=t.observable().extend({errorKeys:{missing:TM("Please enter the artist name.","dev"),validator:function(e){if(!e)return"missing"}}}),this.artistName.subscribe((function(t){s&&s.abort(),t&&(s=e.getJSON("/suggest_subdomain_cb",{name:t,skip_suffixes:!0},(function(e){s=null,e.subdomain_suggestion&&i.subdomain_suggestion(e.subdomain_suggestion)})))})),a.artistName&&i.artistName(a.artistName),this.artistNameFocus=t.observable(),this.geocodedLocation=t.observable(null),this.location=t.observable().extend({errorKeys:{missing:TM("Please enter a location.","dev"),notGeocoded:TM('Please enter an actual geographic location, such as "Seattle, WA."',"dev"),validator:function(e){return e?null:"missing"}}}),LabelUtils.geocode(this.location,this.geocodedLocation),this.locationFocus=t.observable(),setTimeout((function(){i.artistName()?i.locationFocus(!0):i.artistNameFocus(!0)}),0),this.genre=t.observable().extend({errorKeys:{missing:TM("Please choose a genre.","dev"),validator:function(e){return""===e?"missing":null}}}),this.genreTags=t.observableArray().extend({errorKeys:{tooMany:TM("OK, settle down. Please limit yourself to {{max_genres}} genres, no more.","dev",{max_genres:i.MAX_GENRES}),tooLong:TM("Hey now, hey now. Tags may only be 32 characters long.","dev"),community:TM("Tags containing “-bandcamp” are reserved for community-managed projects and cannot be added manually.","dev"),validator:function(e){let t;if(e.length>i.MAX_GENRES)return"tooMany";for(t=0;t<e.length;t++){if(e[t].length>32)return"tooLong";if("-bandcamp"==e[t].substr(-9))return"community"}}}}),this.genreTagsInput=t.observable(""),this.$dialog.subscribe((function(e){e.find(".genre-autocomplete input").bctaginput({tagList:i.genreTags,tagInput:i.genreTagsInput})})),this.genreTagsInputFocus=t.observable(!1),this.removeTag=function(e){i.genreTags.remove(e),i.genreTagsInputFocus(!0)},this.genreTagsHint=t.computed((function(){return i.genreHints[i.genre()]}));var s=null;this.subdomain_user=t.observable().extend({rateLimit:{timeout:400,method:"notifyWhenChangesStop"}}),this.subdomain_suggestion=t.observable();let r=null;function l(t){let a=!1;return Iter.each(t,(function(e){i[e].validate()&&(a=!0)})),a&&e("html, body").animate({scrollTop:e("div.field-wrapper:has(p.error:visible)").offset().top-10},400),a}this.subdomainActiveTaken=t.observable(!1),this.subdomainInactiveTaken=t.observable(!1),this.subdomain=t.computed({read:function(){return i.subdomain_user()&&i.subdomain_user().toLowerCase()||i.subdomain_suggestion()&&i.subdomain_suggestion().toLowerCase()},write:function(e){i.subdomain_user(e),e||(i.subdomain_suggestion(null),s&&(s.abort(),s=null),i.subdomainActiveTaken(!1),i.subdomainInactiveTaken(!1),r&&(r.abort(),r=null))}}).extend({errorKeys:{missing:TM("Please enter a domain.","dev"),invalid:TM("Please enter a value containing only letters, numbers and hyphens. The value must both start and end with a letter or number.","dev"),tooShort:TM("That’s too short.","dev"),tooLong:TM("That’s too long.","dev"),unavailable:TM("That URL is not available.","dev"),validator:function(e){if(!e)return"missing";if(!/^[a-zA-Z0-9\-]+$/i.test(e))return"invalid";if(e.length<4)return"tooShort";if(e.length>63)return"tooLong";return null}}}),this.currentSubdomainOwnerUrl=t.observable(),this.subdomainArtistName="this artist",this.subdomain_user.subscribe((function(t){r&&r.abort(),t&&(r=e.getJSON("/api/label/1/check_subdomain_availability",{subdomain:t},(function(e){r=null,i.subdomainActiveTaken(!!e.subdomain_taken&&!!e.subdomain_active),i.subdomainInactiveTaken(!!e.subdomain_taken&&!e.subdomain_active),i.currentSubdomainOwnerUrl(e.current_owner_url),i.subdomainArtistName=i.artistName()||i.subdomainArtistName})))})),this.hideArtist=t.observable(!1),this.submitXhr=t.observable(null),this.bandItemsPickerVM=new BandItemsPickerVM({defaultSelected:!0,items:a.tralbums}),this.submit=function(){let t,n;t={user_id:Identities.user().id,band_id:Identities.pageBand.id,name:i.artistName(),hide:i.hideArtist(),location:i.location(),genre:i.genre(),genre_tags:i.genreTags(),subdomain:i.subdomain(),tralbums:i.bandItemsPickerVM.paramValue()},i.photoUploader.uploaded()&&(t.image_id=i.photoUploader.imageId(),t.image_hash=i.photoUploader.imageHash()),a.artistName&&(t.name_for_context=a.artistName),Log.debug("validating form",t),l(["artistName","location","genre","genreTags","subdomain"])||(i.subdomainActiveTaken()?i.subdomain.error_key("unavailable"):(n=Crumb.ajax({type:"POST",dataAs:"JSON",url:"/api/label/1/add_new_band",data:t,success:function(e){LabelUtils.showServerErrors(e,i)?i.submitXhr(null):(i.$dialog().dialog("close"),a.successCallback?a.successCallback(e):window.location.reload())},error:function(t,a,n){e("<div>").text(n).dialog({title:a}),i.submitXhr(null)}}),i.submitXhr(n)))}}function n(a){const n=this;this.errorMessage=t.observable(),this.imageId=t.observable(),this.imageHash=t.observable(),this.imageUrl=t.computed((function(){return n.imageId()?ImageUtils.imageURL(n.imageId(),"bio_thumb"):null})),this.uploaded=t.computed((function(){return n.imageId()&&n.imageHash()})),a.subscribe((function(t){e.support.upload?t.find(".upload-photo").on("focus","input[type='file']",(function(){e(this).closest(".upload-photo").find(".action-link").addClass("focus")})).on("blur","input[type='file']",(function(){e(this).closest(".upload-photo").find(".action-link").removeClass("focus")})).find("a").wrapFileInput({select:e.proxy(n.doPhotoUpload,n),click:function(){n.errorMessage(null)},accept:"image/*"}):t.find(".upload-photo").hide()})),this.doPhotoUpload=function(t){const i=a().find(".upload-photo"),o={file:t[0],targetURL:"/band_photo_uploaded",container:i[0],maxSize:4194304,errorHandler:function(e){let t;t=e.responseData&&e.responseData.deets?e.responseData.deets:e.errorMessage?e.errorMessage:TM("Unknown error. Please try again.","dev"),n.errorMessage(TM("Image error:","dev",null,"problem with uploaded image")+" "+t)}};e(window).on("beforeunload.photoupload",(function(){if(uploadImage.uploader&&uploadImage.uploader.working())return"Please wait until your image finishes uploading."})),uploadImage(o,(function(t){t&&t.band_bio&&(n.imageId(t.band_bio.image_id),n.imageHash(t.band_bio.image_hash),e(".field.image-field").height(t.band_bio.thumb.height),e(".field.image-field").width(t.band_bio.thumb.width)),i.find(".upload-progress").fadeOut(),e(window).off("beforeunload.photoupload")}),(function(){i.find(".upload-progress").fadeIn()}))},this.delete=function(){n.imageId(null),n.imageHash(null),e(".field.image-field").height(81),e(".field.image-field").width(105)}}}(jQuery,ko),AddExistingArtistDialog=function(e){"use strict";return{showDialog:function(e){const a=new t(e);return NuDialog.showViewModel(a)}};function t(t){const a=this;t=e.extend({dialogTitle:TM("Add existing artist","dev"),labelItemsPickerVM:null,labelAccountEmail:null,successCallback:function(t,a){"invite"===t?function(t){const a=TM("Request sent to {{band_name}}. Please let them know to be on the lookout for it.","dev",{band_name:"<em>"+Text.escapeHtml(t.new_band.name)+"</em>"}),n={dialogClass:"single-button no-close",buttons:[{text:TM("OK","dev"),click:function(){e(this).dialog("close"),window.location=Identities.pageLabel().url()+"/artists"}}]};NuDialog.alertHTML(TM("Artist invited","dev"),a,n)}(a):window.location=Identities.pageLabel().url()+"/artists"},showBandItems:!0},t||{}),this.templateName=function(){return"label/add_existing_artist"},this.dialogOptions=function(){return{dialogClass:"label-style add-artist single-button add-existing-artist",title:t.dialogTitle,position:"center top+50",buttons:[]}},this.$dialog=ko.observable(),this.band=null,this.subdomain=ko.observable("").extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"},errorKeys:{missing:TM("Please enter a domain.","dev"),invalid:TM("Please enter a value containing only letters, numbers and hyphens. The value must both start and end with a letter or number.","dev"),tooShort:TM("That’s too short.","dev"),tooLong:TM("That’s too long.","dev"),noMatch:TM("That URL doesn’t exist. Please check and try again.","dev"),no_match:TM("That URL doesn’t exist. Please check and try again.","dev"),member_already:TM("This artist is already a member of your label.","dev"),has_service:TM("This artist has an active artist subscription and cannot be added to your label.","dev"),is_label:TM("You cannot add a label.","dev"),validator:function(e){return(e=e.trim())?/^[a-z0-9\-]+$/i.test(e)?e.length<4?"tooShort":e.length>63?"tooLong":a.matchingBand()?null:"noMatch":"invalid":"missing"}}}),t.subdomain&&a.subdomain(t.subdomain),this.subdomainFocus=ko.observable(),setTimeout((function(){a.subdomainFocus(!0)}),0),this.matchingBand=ko.observable(),this.matchingBandName=ko.computed((function(){return a.matchingBand()&&a.matchingBand().name})),this.matchingBandLocation=ko.computed((function(){return a.matchingBand()&&a.matchingBand().pretty_location})),this.matchingBandImageUrl=ko.computed((function(){return a.matchingBand()&&a.matchingBand().image_id&&ImageUtils.imageURL(a.matchingBand().image_id,"bio_navbar")})),this.matchingBandCurrency=ko.computed((function(){return a.matchingBand()&&a.matchingBand().currency})),this.labelCurrency=ko.observable(),this.sameAccount=ko.observable(!1),this.addMethod=ko.observable("password"),this.addMethod.subscribe((function(e){"password"===e&&a.passwordFocus(!0)})),this.usingPassword=ko.computed((function(){return"password"===a.addMethod()})),this.usingEmail=ko.computed((function(){return"invitation"===a.addMethod()})),this.password=ko.observable("").extend({errorKeys:{missing:TM("Please enter a password.","dev"),bad_password:TM("Incorrect password. Please make sure you’re entering the artist name or subdomain, not the username.","dev"),validator:function(e){return e=e.trim(),"password"!==a.addMethod()||e?null:"missing"}}}),this.passwordFocus=ko.observable(!!t.subdomain),this.passwordFocus.subscribe((function(e){e&&a.addMethod("password")})),this.hideArtist=ko.observable(!1),this.submitXhr=ko.observable(null),this.getBandInfoXhr=null,this.bandItemsPickerVM=new BandItemsPickerVM,this.showBandItemsPicker=ko.computed((function(){return t.showBandItems&&a.bandItemsPickerVM.items().length>0&&(a.usingEmail()||!a.sameAccount())&&!a.submitXhr()})).extend({rateLimit:0}),this.labelItemsPickerVM=t.labelItemsPickerVM,this.labelAccountEmail=t.labelAccountEmail,this.currencyChange=ko.computed((function(){return a.matchingBandCurrency()&&a.matchingBandCurrency()!==a.labelCurrency()&&(a.usingPassword()&&a.sameAccount()||a.showBandItemsPicker())})).extend({rateLimit:0}),this.subdomain.subscribe((function(t){a.getBandInfoXhr&&a.getBandInfoXhr.abort(),t&&(a.getBandInfoXhr=e.getJSON("/api/label/1/existing_band_info",{user_id:Identities.user().id,band_id:Identities.pageBand.id,subdomain:t},(function(e){a.getBandInfoXhr=null,a.matchingBand(e.band),a.sameAccount(e.same_account),a.labelCurrency(e.label_currency),a.bandItemsPickerVM.updateItems(e.transferrable_items||[],e.same_account)})))})),this.submit=function(){(function(e){let t=!1;return Iter.each(e,(function(e){a[e].validate()&&(t=!0)})),t})(["subdomain","password"])||function(){let n,i,o;n={user_id:Identities.user().id,band_id:Identities.pageBand.id,subdomain:a.subdomain(),invite_items:a.bandItemsPickerVM.paramValue(),hide:a.hideArtist()},a.labelItemsPickerVM&&(n.transfer_tralbums=Iter.collect(a.labelItemsPickerVM.selectedItems(),(function(e){return e.toHash()})),n.unselected_transfer_tralbums=Iter.collect(a.labelItemsPickerVM.unselectedItems(),(function(e){return e.toHash()})));"password"===a.addMethod()?(n.password=a.password(),i="add"):i="invite";o=Crumb.ajax({type:"POST",dataAs:"JSON",url:"/api/label/1/"+i,data:n,success:function(n){LabelUtils.showServerErrors(n,a)||(a.$dialog().dialog("close"),n.new_band?"add"===i&&n.band_was_pro?function(a,n){const i=TM("Just a heads up that {{band_name}} already had a Pro account. Since you’ve added them to your label account, they will no longer be billed for Bandcamp Pro (their subscription is now cancelled), but they still have all Bandcamp Pro features, as part of your label account.","dev",{band_name:"<em>"+Text.escapeHtml(n.new_band.name)+"</em>"}),o={dialogClass:"single-button no-close",buttons:[{text:TM("Got it","dev",null,"equivalent to OK"),click:function(){e(this).dialog("close"),t.successCallback(a,n)}}]};NuDialog.alertHTML(TM("Add existing artist","dev"),i,o)}(i,n):t.successCallback(i,n):(Log.error("endpoint "+i+" returned no new_band"),NuDialog.alert(TM("Unknown error","dev"),TM("Band was not added. Please try again.","dev"))))},error:NuDialog.showNetworkError,complete:function(){a.submitXhr(null)}}),a.submitXhr(o)}()}}}(jQuery);!function(e,t,a){function n(e){const t=this;this.type=e.type,this.preShowingHandler=e.pre_showing_handler,this.showing=a.observable(!1),this.centralText=e.central_text,this.progress=e.progress,this.tipText=e.tip_text,this.closeText=e.close_text,this.nextTooltip=null,this.show=function(){t.preShowingHandler&&t.preShowingHandler(),BandTooltipAPI.markTooltipViewed(t),t.showing(!0)},this.close=function(){return t.showing(!1),!0},this.continueTips=function(){return t.showing(!1),BandTooltipAPI.dismissTooltip(t),t.nextTooltip&&t.nextTooltip.show(),!0}}t(e).on("load",(function(){const i=t(".trackView"),o=i.data("tooltips"),s=o&&o.tooltips;if(0===i.length||!s||0===s.length)return;const r=o.dash_seen,l=Identities.pageBand.isLabel()?"label":"artist",d=s.indexOf("i"),c=s.indexOf("t"),u=s.indexOf("d");let b,m,p,h;if(d>=0&&(b=d+1,p=new n({type:"i",central_text:TM("add {{bandOrLabel}} photo","dev",{bandOrLabel:l}),tip_text:TM("Add your {{bandOrLabel}} photo here.","dev",{bandOrLabel:l}),progress:TM("Tip {{num}} of {{total}}","dev",{num:b,total:s.length}),close_text:s.length>b?TM("Next tip","dev"):TM("Got it","dev")})),c>=0&&(b=c+1,m=new n({type:"t",central_text:TM("add {{bandOrLabel}} bio","dev",{bandOrLabel:l}),tip_text:TM("Add your {{bandOrLabel}} bio here.","dev",{bandOrLabel:l}),progress:TM("Tip {{num}} of {{total}}","dev",{num:b,total:s.length}),close_text:s.length>b?TM("Next tip","dev"):TM("Got it","dev")})),u>=0&&(h=new n({type:"d",central_text:"dashboard",tip_text:r?TM("You can return to your dashboard here.","dev"):TM("You can visit your dashboard here.","dev"),progress:"",close_text:TM("Got it","dev"),pre_showing_handler:function(){return e.scrollTo(0,0),!0}}),t("#menubar-vm").trigger("dashboardLinkTooltipReady",h)),p){p.nextTooltip=m||h;const e=t(".bio-image.tralbum-tooltip-parent");e&&a.applyBindings(p,e[0]),p.show()}if(m){m.nextTooltip=h;const e=t(".bio-text.tralbum-tooltip-parent");e&&a.applyBindings(m,e[0]),p||m.show()}h&&(p||m||h.show())}))}(window,jQuery,ko);var BandTooltipAPI={markTooltipViewed:function(e){Crumb.ajax({url:"/api/bandtooltips/1/mark_viewed",data:{band_id:Identities.pageBand.id,user_id:Identities.user().id,tooltip:e.type},dataAs:"JSON",type:"POST",success:function(e){e.error&&Log.error("error: ",e.error)},error:function(e,t,a){Log.error("ajax error: ",t,a)}})},dismissTooltip:function(e){Crumb.ajax({url:"/api/bandtooltips/1/dismiss_tooltip",data:{band_id:Identities.pageBand.id,user_id:Identities.user().id,tooltip:e.type},dataAs:"JSON",type:"POST",success:function(e){e.error&&Log.error("error: ",e.error)},error:function(e,t,a){Log.error("ajax error: ",t,a)}})}};!function(e,t){"use strict";function a(){const a=this;this.labelOrBand=Identities.pageBand.isLabel()?"label":"artist",this.artistBioPic=e(".artists-bio-pic")[0],this.photoUploader=new n(this.artistBioPic),this.bio=e(".artists-bio-text").data("initial-values");const i=e(".artists-bio-text").data("max-bio-length");this.savedBioText=t.observable(),this.bioFull=t.observable(),this.bioPartOne=t.observable().extend({liquidFilters:["html_autolink","newline_to_gap"]}),this.bioPartTwo=t.observable().extend({liquidFilters:["html_autolink","newline_to_gap"]}),this.remainingCharacters=t.computed((function(){return a.bioFull()?i-a.bioFull().length:i})),this.editingText=t.observable(!1),this.updatingText=t.observable(!1),this.moreText=t.observable(!1),this.moreOrLess=t.computed((function(){return a.moreText()?TM("less"):TM("more")})),a.bio&&(a.savedBioText(a.bio.bio),a.bioFull(a.savedBioText()),a.bioPartOne(a.bio.bio_part1),a.bioPartTwo(a.bio.bio_part2)),this.dirtyBioText=t.computed((function(){return a.bioFull()!=a.savedBioText()})),e(".artists-bio-pic",this.panel).on("focus","input[type='file']",(function(){e(this).closest(".artists-bio-pic").find(".action-link").addClass("focus")})),e(".artists-bio-pic",this.panel).on("blur","input[type='file']",(function(){e(this).closest(".artists-bio-pic").find(".action-link").removeClass("focus")})),this.showHideMoreBio=function(){a.moreText(!a.moreText())},this.editBioText=function(){a.editingText(!0),e(".artists-bio-text .edit-bio-text-form textarea").focus()},this.cancelBioEdit=function(){a.bioFull(a.savedBioText()),a.editingText(!1)},this.updateBioText=function(){if(a.updatingText(!0),a.bioFull()&&a.bioFull().trim().length>0){if(a.bioFull().length>i)return void NuDialog.alert(TM("Error","dev"),TM("Too many characters - maximum 400","dev"));Crumb.ajax({type:"POST",url:"/api/bandsettings/1/update_bio_text",data:{user_id:Identities.user().id,band_id:Identities.pageBand.id,bio_text:a.bioFull().trim()},success:function(e){a.updatingText(!1),e.errors?Iter.each(e.errors,(function(e){NuDialog.alert(TM("Error","dev"),e.reason)})):e.error?NuDialog.alert(TM("Error","dev"),e.error_message):(a.savedBioText(a.bioFull()),a.bioPartOne(e.bio_parts[0]),a.bioPartTwo(e.bio_parts[1]),a.moreText(!1),a.editingText(!1))},error:function(){a.updatingText(!1),NuDialog.alert(TM("Error","dev"),TM("Unknown error. Please try again.","dev"))},dataAs:"JSON"})}else Crumb.ajax({type:"POST",url:"/api/bandsettings/1/delete_bio_text",data:{user_id:Identities.user().id,band_id:Identities.pageBand.id},success:function(e){a.editingText(!1),a.savedBioText(null),a.bioFull(null),a.bioPartOne(null),a.bioPartTwo(null),a.moreText(!1),e.error&&NuDialog.alert(TM("Error","dev"),e.error_message)},error:function(){NuDialog.alert(TM("Error","dev"),TM("Unknown error. Please try again.","dev"))},dataAs:"JSON"})},this.photoUploader.setupUpload()}function n(a){const n=this;let i;this.container=e(a),i=this.container.data("initial-values"),this.maxPhotoSize=this.container.data("max-photo-size"),this.uploadButton=this.container.find("a.bio-image-upload"),this.progressIndicator=this.container.find(".upload-progress"),this.imageId=t.observable(),this.uploading=t.observable(!1),this.windowWidth=t.observable(),i&&this.imageId(i.image_id),this.imageHash=t.observable(),this.imageUrl=t.computed((function(){return n.imageId()?n.windowWidth()>640?ImageUtils.imageURL(n.imageId(),"bio_thumb"):ImageUtils.imageURL(n.imageId(),"bio_phone"):null})),this.zoomedImageUrl=t.computed((function(){return ImageUtils.imageURL(n.imageId(),"bio_screen")})),this.clean=t.observable(!0),this.setupUpload=function(){e.support.upload?this.uploadButton.wrapFileInput({select:e.proxy(this.doPhotoUpload,this),accept:"image/*"}):this.container.hide()},this.doPhotoUpload=function(t){n.uploading(!0);const a={file:t[0],targetURL:"/band_photo_uploaded",container:this.container.get(0),maxSize:n.maxPhotoSize,errorHandler:function(e){let t;t=e.responseData&&e.responseData.error&&null===e.responseData.member_of_current_band?TM("must be signed in","dev"):e.errorMessage?e.errorMessage:TM("Unknown error. Please try again.","dev"),UploadImageErrors.doDialog(TM("Photo Upload Error","dev"),t)}};e(window).on("beforeunload.photoupload",(function(){if(uploadImage.uploader&&uploadImage.uploader.working())return TM("Please wait until your image finishes uploading.","dev")})),uploadImage(a,(function(t){n.uploading(!1),n._showProgressIndicator(!1),n.clean(!1),e(window).off("beforeunload.photoupload"),t&&t.band_bio&&(n.imageId(t.band_bio.image_id),n.imageHash(t.band_bio.image_hash),n.saveBioImage(t.band_bio.image_id,t.band_bio.image_hash))}),(function(){n._showProgressIndicator(!0)}))},this._showProgressIndicator=function(e){this.progressIndicator["fade"+(e?"In":"Out")]()},this.deleteBioImage=function(){let e={user_id:Identities.user().id,band_id:Identities.pageBand.id};if(Identities.isAdmin()){const t=new URLSearchParams(window.location.search);e.source_type=t.get("source_type"),e.source_id=t.get("source_id"),e.ground=t.get("ground")}Crumb.ajax({type:"POST",url:"/api/bandsettings/1/delete_bio_image",data:e,success:function(e){n.imageId(null),n.imageHash(null),e.error?UploadImageErrors.doDialog(TM("Photo Upload Error","dev"),e.error_message):n.updateMenubarPhoto(null)},dataAs:"JSON"})},this.saveBioImage=function(t,a){Crumb.ajax({type:"POST",url:"/api/bandsettings/1/update_bio_image",data:{user_id:Identities.user().id,band_id:Identities.pageBand.id,image_id:t,image_hash:a},success:function(a){e(window).off("beforeunload.photoupload"),a.error?UploadImageErrors.doDialog(TM("Photo Upload Error","dev"),a.error_message):n.updateMenubarPhoto(t)},dataAs:"JSON"})},this.updateMenubarPhoto=function(e){Identities.pageBand.photo(e)}}e((function(){const n=e("#bio-container")[0]||e("#artist-profile-editable")[0];if(n){const i=new a;t.applyBindings(i,n);const o=e(window);i.photoUploader.windowWidth(o.width()),o.resize((function(){i.photoUploader.windowWidth(o.width())}))}}))}(jQuery,ko);var LabelAddItemDialog=function(e,t){"use strict";return{showDialog:function(e){if(Identities.pageBand.isLabel()||Identities.isParentLabel()){if("live_show"!==e){var t=new a(e);return NuDialog.showViewModel(t),!0}{let n=!1;if(Identities.pageLabel().memberBands().forEach((function(e){e.isAuthed()&&(n=!0)})),n){t=new a(e);return NuDialog.showViewModel(t),!0}return!1}}return!1}};function a(a){const n=this;switch(this.label=Identities.pageLabel(),this.type=a.replace("_"," "),a){case"album":this.labelHint=TM("(e.g., this is a compilation)","dev",null,"reason to add album to label account");break;case"merch":this.labelHint=TM("(e.g., this is a label t-shirt, tote, what have you)","dev",null,"reason to add merch to label account");break;case"listening_party":this.labelHint=TM("(e.g., this is a listening party for a compilation)","dev",null,"reason to add listening party to label account");break;default:this.labelHint=null}if("live_show"===a)this.explanation=TM("Choose whether you’d like to add this live stream to your label or to an artist’s page. Payments for the live stream will be directed to the chosen account.","dev");else this.explanation=null;switch(this.labelName=n.label.name(),a){case"album":this.strDialogTitle=TM("Add album","dev"),this.strAddToLabelAccount=TM("Add album to the {{label_name}} account","dev",{label_name:this.labelName}),this.strAddToExistingArtistAccount=TM("Add album to artist account:","dev");break;case"track":this.strDialogTitle=TM("Add track","dev"),this.strAddToLabelAccount=TM("Add track to the {{label_name}} account","dev",{label_name:this.labelName}),this.strAddToExistingArtistAccount=TM("Add track to artist account:","dev");break;case"merch":this.strDialogTitle=TM("Add merch","dev"),this.strAddToLabelAccount=TM("Add merch to the {{label_name}} account","dev",{label_name:this.labelName}),this.strAddToExistingArtistAccount=TM("Add merch to artist account:","dev");break;case"live_show":this.strDialogTitle=TM("Add live show","dev"),this.strAddToLabelAccount=TM("Add live show to the {{label_name}} account","dev",{label_name:this.labelName}),this.strAddToExistingArtistAccount=TM("Add live show to artist account:","dev");break;case"listening_party":this.strDialogTitle=TM("Add listening party","dev"),this.strAddToLabelAccount=TM("Add listening party to the {{label_name}} account","dev",{label_name:this.labelName}),this.strAddToExistingArtistAccount=TM("Add listening party to artist account:","dev");break;default:this.strAddToLabelAccount=null}this.labelSelected=t.observable(Identities.pageBand.isLabel()),this.labelBandRadioValue=t.computed({read:function(){return n.labelSelected()?"label":"band"},write:function(e){n.labelSelected("label"===e)}}),this.memberBands=[],n.label.memberBands().forEach((function(e){const t=Identities.bmgr.bandByID(e.id);("live_show"===a&&(e.isAuthed()||t)||"live_show"!==a)&&n.memberBands.push({id:e.id,name:e.name(),url:e.trackpipeLocalUrl()})})),n.memberBands.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),this.selectedBand=t.observable(Iter.find(this.memberBands,(function(e){return e.id===Identities.pageBand.id}))||this.memberBands[0]),this.bandSelectClick=function(){return this.labelSelected(!1),!0},this.targetURL=t.computed((function(){const e=n.label.url(),i=n.labelSelected()?e:n.selectedBand().url;return t.unwrap(i)+"/edit_"+a})),this.addNewArtist=function(){n.$dialog().dialog("close"),AddNewArtistDialog.showDialog()},this.addExistingArtist=function(){n.$dialog().dialog("close"),AddExistingArtistDialog.showDialog()},this.templateName=function(){return"label/add_item_dialog"},this.templateHash=function(){return{item_type:a}},this.dialogOptions=function(){return{title:this.strDialogTitle,width:"35em",dialogClass:"label-add-item-dialog",buttons:[{text:TM("Continue","dev"),click:function(){window.location=n.targetURL()}},{class:"secondary",text:TM("Cancel","dev"),click:function(){e(this).dialog("close")}}]}},this.$dialog=t.observable()}}(jQuery,ko);!function(){"use strict";const e=function(){Crumb.ajax({type:"POST",url:"/dismiss_discography_nag_cb",data:{id:Identities.pageBand.id}})};BCEvents.subscribe("bannerDismissed.offer_your_discography",e),BCEvents.subscribe("bannerDismissed.offer_your_discography_label_authed",e)}(),function(e,t,a){"use strict";const n={doPost:function(e,a){const n=t.Deferred();Url.isCustomDomain()&&(e=siteroot_https+e);const i={type:"POST",url:e,data:a,dataType:Url.isCustomDomain()&&!t.support.cors?"jsonp":"json",xhrFields:{withCredentials:!0},success:function(e){return e.error?n.reject():n.resolve(e)},error:function(e,t,a){return n.reject()}};return Crumb.ajax(i),n.promise()},get:function(e,n,i,o,s,r,l,d){const c=t.Deferred(),u={tralbum_type:e,tralbum_id:n,token:i,count:o};r&&(u.exclude_fan_ids=r),"thumbs"===s&&(l&&(u.exclude_gifters=!0),d&&(u.include_reviewers=!0));const b="/api/tralbumcollectors/2/"+s;return t.ajax({url:b,type:"POST",data:a.toJSON(u),contentType:"application/json",dataType:"json"}).then((function(e){return e.error?c.reject():c.resolve(e.results,e.more_available)}),(function(){return c.reject()})),c.promise()},getInitial:function(e,n,i,o,s){const r=t.Deferred(),l={tralbum_type:e,tralbum_id:n,reviews_count:i,thumbs_count:o};return s&&(l.exclude_fan_ids=s),t.post("/api/tralbumcollectors/2/initial",a.toJSON(l)).then((function(e){return e.error?r.reject():r.resolve(e.reviews,e.more_reviews_available,e.thumbs,e.more_thumbs_available)}),(function(){return r.reject()})),r.promise()},getReviews:function(e,t,a,n,i){return this.get(e,t,a,n,"reviews",i)},getThumbs:function(e,t,a,n,i,o,s){return this.get(e,t,a,n,"thumbs",i,s)},getBandThumbs:function(e,n,i){const o=t.Deferred(),s={band_id:e,count:n};return i&&(s.include_reviewers=!0),t.post("/api/tralbumcollectors/2/band_thumbs",a.toJSON(s)).then((function(e){return e.error?o.reject():o.resolve(e.results)}),(function(){return o.reject()})),o.promise()},censorReview:function(e,a,n){const i=t.Deferred(),o={fan_id:e,item_type:a[0],item_id:n};return this.doPost("/censor_fan_review",o).then((function(e){return e&&e.ok?i.resolve():i.reject()})),i.promise()}};e.CollectorsAPI=n}(window,jQuery,ko),function(e,t,a){"use strict";const n=900,i=(t("#pagedata").data("blob")||{}).cfg||{},o=function(e,a,n,i,o){const s=this;s.$container=e instanceof jQuery?e:t(e),s.tralbumType=a,s.tralbumId=n,s.initialized=!1,s.reviews=[],s.shownReviews=[],s.thumbs=[],s.shownThumbs=[],s.shownFanIds={},s.options=o||{},s.lastReviewToken=null,s.lastThumbToken=null,s.loadingThumbs=!1,s.loadingReviews=!1,s.context=i||"collection",s.isPhone="phone"===MediaView.mode,s.fanId="collection"===s.context&&FanData&&FanData.fan_id?FanData.fan_id:null,s.isOwnCollection="collection"===i&&s.fanId&&Identities.fan()&&Identities.fan().id===s.fanId,s.memberOfBand="tralbum"===s.context&&(Identities.isPageBandMember()||Identities.isAdmin()),s.MAX_REVIEWS=6,s.PREVIEW_REVIEWS=3,s.MAX_THUMBS=80,s.PREVIEW_THUMBS=60,s.REVIEWS_BATCH_SIZE=10,s.THUMBS_BATCH_SIZE=100,"tralbum"===s.context&&s.isPhone?s.THUMBS_BATCH_SIZE=60:"collection"===s.context&&s.isPhone&&!s.isOwnCollection?(s.MAX_REVIEWS=4,s.PREVIEW_REVIEWS=3,s.MAX_THUMBS=10,s.PREVIEW_THUMBS=6,s.PREVIEW_THUMBS_NO_COMMENTS=6,s.THUMBS_BATCH_SIZE=60):"collection"===s.context?(s.MAX_THUMBS=66,s.PREVIEW_THUMBS=60,s.PREVIEW_THUMBS_NO_COMMENTS=24,s.THUMBS_BATCH_SIZE=60):"feed"===s.context?(s.MAX_THUMBS=14,s.PREVIEW_THUMBS=7,s.PREVIEW_THUMBS_NO_COMMENTS=7,s.THUMBS_BATCH_SIZE=70):"save_the_fans"===s.context?s.MAX_THUMBS=70:"delete_account"===s.context&&(s.MAX_THUMBS=115),s.options.maxReviews&&(s.MAX_REVIEWS=s.options.maxReviews),s.options.previewReviews&&(s.PREVIEW_REVIEWS=s.options.previewReviews),s.options.maxThumbs&&(s.max_thumbs=s.options.maxThumbs),s.options.previewThumbs&&(s.PREVIEW_THUMBS=s.options.previewThumbs),s.$showMoreReviewsEl=null,s.$showMoreThumbsEl=null,s.$loadingReviewsEl=null,s.$loadingThumbsEl=null};o.prototype.initTooltips=function(){"phone"!==MediaView.mode&&this.$container.bc_tooltips({itemSelector:"a.pic"})},o.prototype.updateTokens=function(){this.lastReviewToken=this.reviews.length>0?this.reviews[this.reviews.length-1].token:null,this.lastThumbToken=this.thumbs.length>0?this.thumbs[this.thumbs.length-1].token:null},o.prototype.showMoreReviews=function(){const e=this;if(!e.initialized||e.loadingReviews)return;const a=[];e.fanId&&"collection"===e.context&&a.push(e.fanId),e.loadingReviews=!0,e.$showMoreReviewsEl.hide(),e.$loadingReviewsEl.show();const o=e.lastReviewToken,s=e.REVIEWS_BATCH_SIZE-(e.reviews.length-e.shownReviews.length),r=new Date;CollectorsAPI.getReviews(e.tralbumType,e.tralbumId,o,s,a).then((function(a,o){const s=new Date-r;let l=0;s<n&&(l=n-s),setTimeout((function(){e.$loadingReviewsEl.hide(),e.reviews=e.reviews.concat(a),e.updateTokens();for(let a=e.shownReviews.length;a<e.reviews.length;a++){const n={review:e.reviews[a],loop_index:a-e.shownReviews.length,member_of_current_band:e.memberOfBand,from_parm:"fanthanks",show_tooltips:!0,cfg:i};if(!e.shownFanIds[n.review.fan_id]){const a=t(Templ.render("fan/collection/grid/also_collected_by_review_innards",n));e.$container.find(".writing:last").after(a),e.shownFanIds[n.review.fan_id]=!0}}e.shownReviews=e.reviews,e.$container.find("img.lazy").lazyload({threshold:500,effect:"fadeIn",effectspeed:100}),t("a.censor",e.$container).click((function(){e.doCensor(this)})),e.initTooltips(),e.loadingReviews=!1,o&&e.$showMoreReviewsEl.fadeIn(200)}),l)}),(function(){e.$loadingReviewsEl.hide(),e.loadingReviews=!1}))},o.prototype.showMoreThumbs=function(){const e=this;if(!e.initialized||e.loadingThumbs)return;e.loadingThumbs=!0,e.$showMoreThumbsEl.hide(),e.$loadingThumbsEl.show();const a=e.lastThumbToken,o=e.THUMBS_BATCH_SIZE-(e.thumbs.length-e.shownThumbs.length),s=new Date;CollectorsAPI.getThumbs(e.tralbumType,e.tralbumId,a,o).then((function(a,o){const r=new Date-s;let l=0;r<n&&(l=n-r),setTimeout((function(){e.$loadingThumbsEl.hide(),e.thumbs=e.thumbs.concat(a),e.updateTokens();const n=t(".no-writing",e.$container),s=[];for(let t=e.shownThumbs.length;t<e.thumbs.length;t++){const a={fan:e.thumbs[t],loop_index:t-e.shownThumbs.length,max_thumbs:e.MAX_THUMBS,from_parm:"fanthanks",show_tooltips:!0,cfg:i};e.shownFanIds[a.fan.fan_id]||(s.push(Templ.render("fan/collection/grid/also_collected_by_no_review_innards",a)),e.shownFanIds[a.fan.fan_id]=!0)}t(n).append(t(s.join(""))),e.shownThumbs=e.thumbs,t("img.lazy",n).lazyload({threshold:500,effect:"fadeIn",effectspeed:100}),e.initTooltips(),e.loadingThumbs=!1,o&&e.$showMoreThumbsEl.fadeIn(200)}),l)}),(function(){e.$loadingThumbsEl.hide(),e.loadingThumbs=!1}))},o.prototype.renderFull=function(e){const a=this,o=t.Deferred(),s=function(e,t,n,s){if(a.initialized=!0,0===e.length&&0===n.length)return;a.reviews=e,a.thumbs=n,a.updateTokens();const r={reviews:e,more_reviews_available:t,thumbs:n,more_thumbs_available:s,from_parm:"fanthanks",member_of_current_band:a.memberOfBand,show_tooltips:!0,cfg:i};if(a.shownThumbs=n,a.shownReviews=e,a.shownFanIds={},e&&t&&(r.reviews=r.reviews.slice(0,a.PREVIEW_REVIEWS),a.shownReviews=a.shownReviews.slice(0,a.PREVIEW_REVIEWS)),n&&s){const t=e&&e.length>0?a.PREVIEW_THUMBS_NO_COMMENTS:a.PREVIEW_THUMBS;r.thumbs=r.thumbs.slice(0,t),a.shownThumbs=a.shownThumbs.slice(0,t)}if(r.thumbs){const e=[];Iter.each(r.thumbs,(function(t){a.shownFanIds[t.fan_id]||(a.shownFanIds[t.fan_id]=!0,e.push(t))})),r.thumbs=e}a.$container.renderLiquid("tralbum_common/tralbum_collectors",r),a.$container.addClass("populated"),a.bindToDOM(),a.initTooltips(),o.resolve()};if(e)s(e.reviews,e.more_reviews_available,e.thumbs,e.more_thumbs_available);else{const e=[];a.fanId&&"collection"===a.context&&e.push(a.fanId),a.$container.show();const t=new Date;CollectorsAPI.getInitial(a.tralbumType,a.tralbumId,a.MAX_REVIEWS,a.MAX_THUMBS,e).then((function(e,a,i,o){const r=new Date-t;let l=0;r<n&&(l=n-r),setTimeout((function(){s(e,a,i,o)}),l)}))}return o.promise()},o.prototype.set=function(e){const t=this;e=e||{},t.reviews=e.reviews||[],t.thumbs=e.thumbs||[],t.shownReviews=e.shown_reviews||[],t.shownThumbs=e.shown_thumbs||[],t.moreReviewsAvailable=e.more_reviews_available,t.moreThumbsAvailable=e.more_thumbs_available,t.shownFanIds={},Iter.each(t.shownThumbs,(function(e){t.shownFanIds[e.fan_id]||(t.shownFanIds[e.fan_id]=!0)})),t.updateTokens()},o.prototype.bindToDOM=function(){const e=this;e.$showMoreReviewsEl=t(".more-writing",e.$container),e.$showMoreThumbsEl=t(".more-thumbs",e.$container),e.$loadingReviewsEl=t(".loading-writing",e.$container),e.$loadingThumbsEl=t(".loading-thumbs",e.$container),e.$showMoreReviewsEl.click((function(){e.showMoreReviews()})),e.$showMoreThumbsEl.click((function(){e.showMoreThumbs()})),t("a.censor",e.$container).click((function(){e.doCensor(this)})),e.initTooltips(),e.$container.find("img.lazy").lazyload({threshold:500,effect:"fadeIn",effectspeed:100}),e.initialized=!0},o.prototype.renderNano=function(e,t,a,n){const i=this;t=t||i.MAX_THUMBS;const o=function(e){const o={collectors:t?e.slice(0,t):e,from_parm:a,target_blank:n};i.$container.renderLiquid("fan/collection/grid/also_collected_by_nano",o)};e?o(e.collectors):"delete_account"===i.context&&i.options.bandId?(i.$container.show(),CollectorsAPI.getBandThumbs(i.options.bandId,t,!0).then((function(e){o(e)}))):(i.$container.show(),CollectorsAPI.getThumbs(i.tralbumType,i.tralbumId,null,t,null,!0,!0).then((function(e){o(e)})))},o.prototype.doCensor=function(e){const a=t(e),n=a.closest(".writing"),i=a.data("fan-id"),o=a.data("item-type"),s=a.data("item-id"),r=a.data("fan-name"),l=TM("Are you sure you want to remove the text of {{fan_name}}? This action cannot be reversed.","dev",{fan_name:r});NuDialog.alert(TM("Remove","dev"),l,{buttons:[{text:TM("OK","dev"),click:function(){CollectorsAPI.censorReview(i,o,s).then((function(){n.slideToggleBool(!1)})),t(this).dialog("close")}},{text:TM("Cancel","dev"),click:function(){t(this).dialog("close")}}]})},e.FanTralbumCollectors=o}(window,jQuery,ko);var SaveTheFans={};!function(e){"use strict";SaveTheFans.show_dialog=function(e,t,a){const n=a.dlg_title||TM("But they LOVE you!","dev");NuDialog.showTemplate("fan/but_they_love_you",a,{title:n,buttons:[{text:TM("Yes, proceed","dev"),click:function(){e&&e(),$(this).dialog("close")}},{text:TM("Cancel","dev"),click:function(){Stats.record({kind:"click",click:"svdfns_trlbm_cancel"}),t&&t(),$(this).dialog("close")}}],open:function(){new FanTralbumCollectors($("#fan-thumbs")[0],TralbumData.item_type[0],TralbumData.id,"save_the_fans").renderNano(null,a.max_shown,"svdfns_trlbm"),setTimeout((function(){$(".ui-dialog-content").dialog("option","position","center")}),2e3)}})}}();var SaveTheLicensees={};!function(e){"use strict";SaveTheLicensees.show_dialog=function(e,t,a){const n=a.dlg_title||TM("But wait...","dev"),i="<p>"+TP("You are about to remove your music from 1 license discography. This means you’ll no longer benefit from the promotion that licensee’s page gives you. We’ll notify your licensee via email.","You are about to remove your music from {{count}} license discographies. This means you’ll no longer benefit from the promotion those licensees’ pages give you. We’ll notify your licensees via email.",a.num_licensees,"dev")+"</p><p>"+TM("Are you sure you want to proceed?","dev")+"</p>";NuDialog.alertHTML(n,i,{buttons:[{text:TM("Yes, publish as private","dev"),click:function(){e&&e(),$(this).dialog("close")}},{text:TM("Cancel","dev"),click:function(){t&&t(),$(this).dialog("close")}}],dialogClass:"wide-button",width:"40em"})}}(),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/but_they_love_you.liquid","warn"):Templ.register({"fan/but_they_love_you":['<style type="text/css">\n#but-they-love-you .devestation-header {\n    margin-top: 16px;\n}\n#but-they-love-you .collected-by, #but-they-love-you .deets {\n    border: none;\n}\n#but-they-love-you .collected-by a.fan {\n    text-decoration: none;\n    margin-right: 3px;\n}\n</style>\n<div id="but-they-love-you">\n    <p style="margin-bottom:.2em;">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"!suppress_message ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"num_licensees > 0 ",attachment:["\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"num_licensees > 1 ",attachment:["\n                ",{type:"translatePlural",blocks:[{type:"ncondition",expression:"num_collectors== 1",attachment:["\n                    You are about to remove your music from 1 public fan\n                    collection page and ",{type:"variable",name:"num_licensees",filters:[["h",[]]]}," licensee\n                    discographies. The fan who purchased this release will still\n                    be able to stream and download it, but you’ll no longer\n                    benefit from the promotion that fan’s and licensees’ pages\n                    give you. We’ll notify your licensees via email.\n                "]},{type:"else_ncondition",attachment:["\n                    You are about to remove your music from ",{type:"variable",name:"num_collectors",filters:[["h",[]]]},"\n                    public fan collection pages and ",{type:"variable",name:"num_licensees",filters:[["h",[]]]}," licensee\n                    discographies. Fans who purchased this release will still be\n                    able to stream and download it, but you’ll no longer benefit\n                    from the promotion those fans’ and licensees’ pages give\n                    you. We’ll notify your licensees via email.\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translatePlural",blocks:[{type:"ncondition",expression:"num_collectors== 1",attachment:["\n                    You are about to remove your music from 1 public fan\n                    collection page and 1 licensee discography. The fan who\n                    purchased this release will still be able to stream and\n                    download it, but you’ll no longer benefit from the promotion\n                    that fan’s and licensee’s pages give you. We’ll notify your\n                    licensee via email.\n                "]},{type:"else_ncondition",attachment:["\n                    You are about to remove your music from ",{type:"variable",name:"num_collectors",filters:[["h",[]]]},"\n                    public fan collection pages and 1 licensee discography. Fans\n                    who purchased this release will still be able to stream and\n                    download it, but you’ll no longer benefit from the promotion\n                    those fans’ and licensee pages give you. We’ll notify your\n                    licensee via email.\n                "]}]},"\n            "]}]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translatePlural",blocks:[{type:"ncondition",expression:"num_collectors== 1",attachment:["\n                You are about to remove your music from 1 public fan collection\n                page. The fan who purchased this release will still be able to\n                stream and download it, but you’ll no longer benefit from the\n                promotion that fan’s page gives you.\n            "]},{type:"else_ncondition",attachment:["\n                You are about to remove your music from ",{type:"variable",name:"num_collectors",filters:[["h",[]]]},"\n                public fan collection pages. Fans who purchased this release\n                will still be able to stream and download it, but you’ll no\n                longer benefit from the promotion those fans’ pages give you.\n            "]}]},"\n        "]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"add_breaks ",attachment:["<br><br>"]}]},"\n        ",{type:"translate",nodelist:["Are you sure you want to proceed?"]},"\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"custom_message ",attachment:["\n        ",{type:"variable",name:"custom_message",filters:[["h",[]]]},"\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"totally_destructive ",attachment:["\n        <strong>",{type:"translate",nodelist:["This cannot be undone."]},"</strong>\n    "]}]},"\n    </p>\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"num_collectors_with_photos && num_collectors_with_photos > 0 ",attachment:['\n        <div class="devestation-header">\n        ',{type:"ef",blocks:[{type:"ncondition",expression:"num_collectors_with_photos == 1 ",attachment:["\n            ",{type:"translate",nodelist:["Let’s give it up for this guy right here:"]},"\n        "]},{type:"ncondition",expression:"max_shown && num_collectors_with_photos > max_shown ",attachment:["\n            ",{type:"translate",nodelist:["Here are just some of the fans who will be devastated:"]},"\n        "]},{type:"else_ncondition",attachment:["\n            ",{type:"translate",nodelist:["Here are the fans who will be devastated:"]},"\n        "]}]},"\n        </div>\n    "]}]},'\n    <div id="fan-thumbs"></div>\n\n</div>\n']}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/fan/collection/grid/also_collected_by_nano.liquid","warn"):Templ.register({"fan/collection/grid/also_collected_by_nano":[{type:"ef",blocks:[{type:"ncondition",expression:"collectors && collectors.length > 0 ",attachment:['\n<div class="collected-by">\n    <div class="deets">\n    ',{type:"for",collection_name:"collectors",nodelist:['\n    <a class="fan pic" href="',{type:"variable",name:"fan.username",filters:[["fan_page_url",[]],["a",[]]]},"?from=",{type:"variable",name:"from_parm",filters:[["u",[]],["a",[]]]},'" ',{type:"ef",blocks:[{type:"ncondition",expression:"target_blank ",attachment:['target="_blank"']}]},'>\n        <img class="thumb" src="',{type:"variable",name:"fan.image_id",filters:[["image_url",["50"]],["a",[]]]},'" alt="',{type:"variable",name:"fan.name",filters:[["a",[]]]},' thumbnail"/>\n    </a>\n    '],variable_name:"fan",reversed:null,attribs:{}},"\n    </div>\n</div>\n"]}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/add_new_artist.liquid","warn"):Templ.register({"label/add_new_artist":['<form id="add-new-artist" class="modern-form">\n\n    <div class="field-wrapper name">\n        <label class="title">',{type:"translate",nodelist:["Artist name"]},'</label>\n        <div class="field"><input class="center" type="text" name="artistName" data-bind="value: artistName, hasFocus: artistNameFocus, attr: {disabled: submitXhr}" /></div>\n        <p class="error" data-bind=\'animateText: artistName.error_msg, animationType: "slide"\'></p>\n    </div>\n\n    <div class="field-wrapper location">\n        <label class="title">',{type:"translate",nodelist:["Location"]},'</label>\n        <div class="field">\n            <input class="center" type="text" placeholder="',{type:"translate",nodelist:["e.g. Seattle, WA"]},'"\n                data-bind=\'value: location, valueUpdate: "input", hasFocus: locationFocus, attr: {disabled: submitXhr}\'/>\n        </div>\n        <div class="suggestion save-the-orphan" data-bind=\'animateVisible: geocodedLocation, animationType: "slide"\'>\n            ',{type:"translate",nodelist:["Location will be set to:"]},' <b data-bind=\'text: geocodedLocation\'></b>\n        </div>\n        <p class="error" data-bind=\'animateText: location.error_msg, animationType: "slide"\'></p>\n    </div>\n\n    <div class="field-wrapper genre">\n        <label class="title">',{type:"translate",nodelist:["Genre"]},'</label>\n        <div class="field">\n        \t<select name="genre" data-bind="value: genre, attr: {disabled: submitXhr}">\n                <option value="" selected>',{type:"translate",nodelist:["select one"]},"</option>\n                ",{type:"for",collection_name:"genre_data",nodelist:['\n                <option value="',{type:"variable",name:"opt.id",filters:[["attr",[]]]},'"',{type:"ef",blocks:[{type:"ncondition",expression:"genre_id == opt.id ",attachment:[" selected"]}]},">",{type:"variable",name:"opt.name",filters:[["h",[]]]},"</option>\n                "],variable_name:"opt",reversed:null,attribs:{}},'\n        \t</select>\n            <p class="hint">',{type:"translate",nodelist:["Your genre selection determines where your music appears in <a ",{type:"translateVariable",var_name:"href",nodelist:['href="',{type:"variable",name:"siteroot_current",filters:[["a",[]]]},'/discover"']},">Bandcamp Discover</a>. It’s OK if you don’t fit perfectly within one of these – just use the genre tag field, below, to provide more granularity."]},'</p>\n        </div>\n        <p class="error" data-bind=\'animateText: genre.error_msg, animationType: "slide"\'></p>\n    </div>\n\n    <div class="field-wrapper genre-tags genre-autocomplete">\n        <label class="title">',{type:"translate",nodelist:["Genre tags"]},'</label>\n        <div class="field">\n            <input type="text" name="genreTags"\n                data-bind="value: genreTagsInput,\n                           valueUpdate: \'input\',\n                           attr: {placeholder: genreTagsHint, disabled: submitXhr},\n                           hasFocus: genreTagsInputFocus">\n        </div>\n        <div class="tag-list" data-bind="foreach: genreTags, visible: genreTags().length > 0">\n            <span class="tag" data-bind="click: $parent.removeTag">\n                <span data-bind="text: $data"></span>\n                <button type="button" class="close">&times;</button>\n            </span>\n            <p class="hint" data-bind="visible: $parent.genreTags().length === 0">',{type:"translate",nodelist:["Optional."]},'</p>\n        </div>\n        <p class="error" data-bind=\'animateText: genreTags.error_msg, animationType: "slide"\'></p>\n    </div>\n\n    <div class="field-wrapper subdomain">\n        <label class="title" for="add-new-artist-subdomain-field">',{type:"translate",nodelist:["URL"]},'</label>\n        <label class="field">\n            <span class="add-artist-subdomain-prefix">http://</span>\n            <input type="text" id="add-new-artist-subdomain-field" class="add-artist-subdomain-field"\n                data-bind=\'value: subdomain, valueUpdate: "input", attr: {disabled: submitXhr}\'>\n            <span class="add-artist-subdomain-suffix">.bandcamp.com</span>\n            <p class="hint save-the-orphan">',{type:"translate",nodelist:["You can point your own URL/custom domain here later."]},'</p>\n        </label>\n        <p class="error" data-bind=\'animateText: subdomain.error_msg, animationType: "slide"\'></p>\n        <p class="error" data-bind=\'animateVisible: subdomainActiveTaken(), animationType: "slide"\'>\n            ',{type:"translate",nodelist:["That URL is unavailable. If <a ",{type:"translateVariable",var_name:"subdomain_href",nodelist:['data-bind="attr: {href: currentSubdomainOwnerUrl}" target="_blank"']},">this</a> looks like the correct site for ",{type:"translateVariable",var_name:"band_name",nodelist:['<span data-bind="text: subdomainArtistName"></span>']},", please <a ",{type:"translateVariable",var_name:"existing_artist_href",nodelist:['data-bind="click: swapToExistingArtistDialog"']},">click here</a>. If not, please pick a different URL."]},'\n        </p>\n    </div>\n\n    <div class="field-wrapper hide-artist">\n        <label class="title">',{type:"translate",nodelist:["Hide artist"]},'</label>\n        <label class="field">\n                <p class="hint"><span class="checkbox leftward"><input type="checkbox" name="hide" data-bind=\'checked: hideArtist, attr: {disabled: submitXhr}\'/></span>',{type:"translate",nodelist:["You can hide and unhide artists later, too."]},'</p>\n                \n        </label>\n    </div>\n\n    <div class="field-wrapper upload-photo">\n\t\t<label class="title">',{type:"translate",nodelist:["Photo"]},'</label>\n\t\t<div class="field image-field">\n\t\t\t<a class="action-link" data-bind="visible: !photoUploader.imageUrl() && !submitXhr()">',{type:"translate",nodelist:["upload photo"]},'</a>\n            <div data-bind="if: photoUploader.imageUrl">\n                <img data-bind="attr: {src: photoUploader.imageUrl}" src="" alt="">\n                <a class="delete-link" data-bind="click: photoUploader.delete">X</a>\n            </div>\n\t\t</div>\n        <p class="hint">',{type:"translate",nodelist:["640px minimum width, landscape orientation, .jpg, .gif or .png<br/><br/>(you can also add this later)"]},'</p>\n        <div class="upload-progress"></div>\n        <p class="error" data-bind=\'animateText: photoUploader.errorMessage, animationType: "slide"\'></p>\n    </div>\n\n    \x3c!-- ko if: bandItemsPickerVM.items().length > 0 --\x3e\n    <div class="field-wrapper add-artist-tralbum-picker">\n\t\t<label class="title">',{type:"translate",nodelist:["Releases"]},'</label>\n\t\t<div class="field">\n            \x3c!-- ko if: bandItemsPickerVM.items().length == 1 --\x3e\n\t\t\t    <p>',{type:"translate",nodelist:["Move the following release from the ",{type:"translateVariable",var_name:"page_band",nodelist:['<span data-bind="text: Identities.pageBand.name"></span>']}," account into the new ",{type:"translateVariable",var_name:"band_name",nodelist:['<span data-bind="text: artistName"></span>']}," account:"]},"</p>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: bandItemsPickerVM.items().length == 1 --\x3e\n\t\t\t    <p>",{type:"translate",nodelist:["Move the following releases from the ",{type:"translateVariable",var_name:"page_band",nodelist:['<span data-bind="text: Identities.pageBand.name"></span>']}," account into the new ",{type:"translateVariable",var_name:"band_name",nodelist:['<span data-bind="text: artistName"></span>']}," account:"]},"</p>\n            \x3c!-- /ko --\x3e\n\n            \x3c!-- ko with: bandItemsPickerVM --\x3e\n            ",{type:"include",template_name:"'label/band_items_picker'"},'\n            \x3c!-- /ko --\x3e\n\t\t</div>\n    </div>\n    \x3c!-- /ko --\x3e\n\n    <div class="field-wrapper button">\n        <div class="field no-title">\n            <button class="center label-signup-submit"\n                data-bind="click: submit, disable: submitXhr">\n                \x3c!-- ko if: submitXhr --\x3e',{type:"translate",nodelist:["Please wait&hellip;"]},"\x3c!-- /ko --\x3e\n                \x3c!-- ko ifnot: submitXhr --\x3e",{type:"translate",nodelist:["Add artist"]},"\x3c!-- /ko --\x3e\n            </button>\n        </div>\n    </div>\n\n</form>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/add_existing_artist.liquid","warn"):Templ.register({"label/add_existing_artist":['<form class="modern-form">\n\n    <p class="add-artist-instructions">',{type:"translate",nodelist:["Please specify an account to add."]},'</p>\n    \n    <div class="field-wrapper subdomain">\n        <label class="title" for="add-existing-artist-subdomain-field">',{type:"translate",nodelist:["Artist URL"]},'</label>\n        <label class="field">\n            <span class="add-artist-subdomain-prefix">http://</span>\n            <input type="text" id="add-existing-artist-subdomain-field" class="add-artist-subdomain-field"\n                data-bind=\'value: subdomain, valueUpdate: "input", hasFocus: subdomainFocus, attr: {disabled: submitXhr, autofocus: subdomainFocus()}\'>\n            <span class="add-artist-subdomain-suffix">.bandcamp.com</span>\n        </label>\n        <p class="error save-the-orphan" data-bind=\'animateText: subdomain.error_msg, animationType: "slide"\'></p>\n        <div class="add-artist-matching-band" data-bind="css: {\'has-match\': matchingBand()}">\n            <img src="" alt="" data-bind=\'attr: {"src": matchingBandImageUrl}, visible: matchingBandImageUrl\'>\n            <span class="band-name" data-bind="text: matchingBandName"></span>,\n            <span class="band-location" data-bind="text: matchingBandLocation"></span>\n        </div>\n        \n    </div>\n\n    <div class="titled-field">\n        <label class="title">',{type:"translate",nodelist:["Add via"]},'</label>\n        <div class="field">\n            <span class="radio">\n                <input type="radio" name="addMethod" value="password" data-bind="checked: addMethod, attr: {disabled: submitXhr}">\n            </span>\n            <input type="password" class="short-password" placeholder="',{type:"translate",nodelist:["Password"]},'"\n                data-bind=\'value: password, valueUpdate: "input", hasFocus: passwordFocus(), attr: {disabled: submitXhr, autofocus: passwordFocus()}\'>\n        </div>\n        <p class="error sub-field" data-bind=\'animateText: password.error_msg, animationType: "slide"\'></p>\n\n        <div class="field no-title">\n            <span class="radio">\n        \t   <input type="radio" name="addMethod" id="add-method-invitation" value="invitation" data-bind="checked: addMethod, attr: {disabled: submitXhr}">\n            </span>\n\t        <label for="add-method-invitation" class="radio-label">',{type:"translate",nodelist:["Request access from the artist"]},'</label>\n        </div>\n        <p class="error" data-bind=\'animateText: addMethod.error_msg, animationType: "slide"\'></p>\n    </div>\n\n    <div class="field-wrapper hide-artist">\n        <label class="title">',{type:"translate",nodelist:["Hide artist"]},'</label>\n        <label class="field">\n                <p class="hint">\n                <span class="checkbox"><input class="center" type="checkbox" name="hide" data-bind=\'checked: hideArtist, attr: {disabled: submitXhr}\'/></span> ',{type:"translate",nodelist:["You can hide and unhide artists later, too."]},'\n                </p>\n        </label>\n    </div>\n\n    <div class="field-wrapper add-artist-tralbum-picker" data-bind=\'animateVisible: showBandItemsPicker, animationType: "slide"\'>\n        <label class="title">',{type:"translate",nodelist:["Releases"]},'</label>\n        <div class="field">\n            \x3c!-- ko if: usingEmail --\x3e\n                <p>',{type:"translate",nodelist:["Please select which items, if any, should have their payments directed to ",{type:"translateVariable",var_name:"band_name",nodelist:['<span data-bind="text: Identities.pageBand.name"></span>']}," when the artist accepts your invitation:"]},"</p>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: usingEmail --\x3e\n                <p>",{type:"translate",nodelist:["Please select which items, if any, should have their payments directed to ",{type:"translateVariable",var_name:"band_name",nodelist:['<span data-bind="text: Identities.pageBand.name"></span>']},":"]},"</p>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko with: bandItemsPickerVM --\x3e\n            ",{type:"include",template_name:"'label/band_items_picker'"},'\n            \x3c!-- /ko --\x3e\n        </div>\n    </div>\n\n    <div class="currency-change-warning" data-bind="animateVisible: currencyChange, animationType: \'slide\'">\n        \x3c!-- ko if: showBandItemsPicker --\x3e\n            ',{type:"translate",nodelist:["Selected item prices will be changed from ",{type:"translateVariable",var_name:"band_currency",nodelist:['<span data-bind="text: matchingBandCurrency"></span>']},"\n            to ",{type:"translateVariable",var_name:"label_currency",nodelist:['<span data-bind="text: labelCurrency"></span>']},"."]},"\n        \x3c!-- /ko --\x3e\n        \x3c!-- ko ifnot: showBandItemsPicker --\x3e\n            ",{type:"translate",nodelist:["This artist’s item prices will be changed from ",{type:"translateVariable",var_name:"band_currency",nodelist:['<span data-bind="text: matchingBandCurrency"></span>']},"\n            to ",{type:"translateVariable",var_name:"label_currency",nodelist:['<span data-bind="text: labelCurrency"></span>']},"."]},"\n        \x3c!-- /ko --\x3e\n        ",{type:"translate",nodelist:["Please double check prices after the conversion."]},'\n    </div>\n\n    <div class="field-wrapper add-artist-tralbum-picker" data-bind=\'visible: labelItemsPickerVM\'>\n        <label class="title">',{type:"translate",nodelist:["Releases"]},'</label>\n        <div class="field">\n            <p>\n                ',{type:"translate",nodelist:["\n                Move the following items from ",{type:"translateVariable",var_name:"page_band",nodelist:['<span data-bind="text: Identities.pageBand.name"></span>']},"\n                into the ",{type:"translateVariable",var_name:"band_name",nodelist:["<span data-bind=\"text: matchingBandName() || 'artist'\"></span>"]}," account\n                (payments will continue going to ",{type:"translateVariable",var_name:"label_email",nodelist:['<span data-bind="text: labelAccountEmail">you</span>']},"):\n                "]},"\n            </p>\n\n            \x3c!-- ko with: labelItemsPickerVM --\x3e\n            ",{type:"include",template_name:"'label/band_items_picker'"},'\n            \x3c!-- /ko --\x3e\n        </div>\n    </div>\n\n    <div class="field-wrapper button">\n        <div class="field no-title">\n            <button class="center label-signup-submit"\n                data-bind="click: submit, disable: submitXhr">\n                \x3c!-- ko if: submitXhr --\x3e',{type:"translate",nodelist:["Please wait&hellip;"]},"\x3c!-- /ko --\x3e\n                \x3c!-- ko ifnot: submitXhr --\x3e\n                \t\x3c!-- ko if: addMethod() === 'password' --\x3e",{type:"translate",nodelist:["Add"]},"\x3c!-- /ko --\x3e\n                \t\x3c!-- ko if: addMethod() !== 'password' --\x3e",{type:"translate",nodelist:["Next"]},"\x3c!-- /ko --\x3e\n                \x3c!-- /ko --\x3e\n            </button>\n        </div>\n    </div>\n\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/band_items_picker.liquid","warn"):Templ.register({"label/band_items_picker":['<div class="band-items-picker-vm">\n    <ul class="band-items-picker-list" data-bind="foreach: sortedItems">\n        <li><label data-bind="css: {disabled: !enabled()}">\n            <input class="band-items-picker-checkbox" type="checkbox" value="" data-bind="checked: selected, enable: enabled" />\n            <img class="band-items-picker-thumb" data-bind="src_art: {art_id: artId, format: \'bio_navbar\'}">\n            <span class="band-items-picker-title" data-bind="text: displayTitle"></span>\n        </label></li>\n    </ul>\n    <p class="band-items-picker-hint">\n        ',{type:"translate",nodelist:["\n        ",{type:"translateVariable",var_name:"count",nodelist:['<span data-bind="text: selectedItems().length"></span>']}," of\n        ",{type:"translateVariable",var_name:"select_count",nodelist:['<span data-bind="text: enabledItems().length"></span>']}," selected\n        "]},"\n    </p>\n</div>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/artists_grid_item.liquid","warn"):Templ.register({"label/artists_grid_item":["<li class='artists-grid-item ",{type:"ef",blocks:[{type:"ncondition",expression:"member_band.featured_date ",attachment:["featured"]},{type:"ncondition",expression:"odd ",attachment:["odd"]}]},"' \n    ",{type:"ef",blocks:[{type:"ncondition",expression:"!member_band.photo ",attachment:["data-bind=\"css: { 'no-art': !imageUrl() }\""]}]}," data-item-id='",{type:"variable",name:"member_band.id",filters:[["a",[]]]},"'>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"member_of_current_band ",attachment:["\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"member_band.photo ",attachment:["<a href='",{type:"variable",name:"member_band.to_artist_url",filters:[["a",[]]]},"'>"]}]},'\n        <div class="artists-grid-pic art" data-bind="css: { \'artists-grid-pic-uploaded\': !!imageUrl() }">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"member_band.photo ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"forloop.index0 < (n_columns * 2) ",attachment:['\n                    <img src="',{type:"variable",name:"member_band.photo",filters:[["image_url",["'package_page'"]],["a",[]]]},'" alt="" />\n                ']},{type:"else_ncondition",attachment:['\n                    <img src="/img/43.gif" data-original="',{type:"variable",name:"member_band.photo",filters:[["image_url",["'package_page'"]],["a",[]]]},'" alt="" class="lazy" />\n                ']}]},"\n            "]},{type:"else_ncondition",attachment:['\n                   \x3c!-- ko if: imageUrl --\x3e\n                   <img alt="" src="" data-bind="attr: { src: imageUrl }" class="hidden-while-loading" /> \n                   \x3c!-- /ko --\x3e\n            ']}]},'\n            \x3c!-- ko if: featurable() && !gridVM.featuredFull() --\x3e\n                <div class="featured-thumb" data-bind="click: addToFeatured, css: {\'featured\': featured}" title="feature this artist"><div class="bc-ui"></div></div>\n            \x3c!-- /ko --\x3e\n            <div class="warning-badges">\n            <span class="warningBadge stackable hidden-while-loading" data-bind="visible: isHidden()">',{type:"translate",nodelist:["hidden"]},"</span>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"!member_band.is_licensed_band_only ",attachment:['\n                <span class="warningBadge stackable hidden-while-loading" data-bind="visible: !hasPublicItems()">\n                ',{type:"translate",nodelist:["no items"]},"</span>\n            "]}]},'\n            <span class="warningBadge stackable level-orange hidden-while-loading" data-bind="visible: state() == \'i\'">',{type:"translate",nodelist:["invited"]},'</span>\n            <span class="warningBadge stackable level-orange hidden-while-loading" data-bind="visible: transferRequest">',{type:"translate",nodelist:["transferring"]},"</span>\n            &nbsp;\n            </div>\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"!member_band.photo && !is_phone ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"member_band.authed ",attachment:['\n                    <button class="image-upload notSkinnable">',{type:"translate",nodelist:["Add an artist photo"]},'</button>\n                    <div class="upload-progress" data-bind="visible: !imageUrl()"></div>\n                    <div class="error" data-bind="visible: errorMessage, text: errorMessage"></div>\n                ']},{type:"else_ncondition",attachment:['\n                    <span class="image-upload poke">',{type:"translate",nodelist:["",{type:"translateVariable",var_name:"band_name",nodelist:[{type:"variable",name:"member_band.name",filters:[["h",[]]]}]}," doesn’t have a photo, <span ",{type:"translateVariable",var_name:"attr",nodelist:['class="part2"']},">please suggest they add one!</span>"]},"</span>\n                "]}]},"\n            "]}]},"\n        </div>\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"member_band.photo ",attachment:['\n            <div class="artists-grid-name">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</div>\n            </a>\n        "]},{type:"else_ncondition",attachment:["\n            <a href='",{type:"variable",name:"member_band.to_artist_url",filters:[["a",[]]]},'\'><div class="artists-grid-name">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</div></a>\n        "]}]},"\n    "]},{type:"else_ncondition",attachment:["\n        <a href='",{type:"variable",name:"member_band.to_artist_url",filters:[["a",[]]]},'\'>\n            <div class="artists-grid-pic art">\n                ',{type:"ef",blocks:[{type:"ncondition",expression:"member_band.photo ",attachment:["\n                    ",{type:"ef",blocks:[{type:"ncondition",expression:"forloop.index0 < (n_columns * 2) ",attachment:['\n                        <img src="',{type:"variable",name:"member_band.photo",filters:[["image_url",["'package_page'"]],["a",[]]]},'" alt="" />\n                    ']},{type:"else_ncondition",attachment:['\n                        <img src="/img/43.gif" data-original="',{type:"variable",name:"member_band.photo",filters:[["image_url",["'package_page'"]],["a",[]]]},'" alt="" class="lazy" />\n                    ']}]},"\n                "]}]},'\n            </div>\n            <div class="artists-grid-name">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</div>\n        </a>\n    "]}]},'\n\n    <div class="artists-grid-location secondaryText">',{type:"variable",name:"member_band.pretty_location",filters:[["h",[]]]},"</div>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"member_of_current_band && !is_phone ",attachment:["\n        <div class='artists-grid-owner-actions'>\n            \n            \x3c!-- ko if: state() === 'a' --\x3e\n                <button class='artists-grid-remove custom-link-color' data-bind=\"click: remove\">\n                    ",{type:"translate",nodelist:["remove ",{type:"translateVariable",var_name:"band_name",nodelist:['<span class="hidden-access">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</span>"]},""]},"\n                </button>\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"member_band.authed ",attachment:["\n                    <button class='artists-grid-give-access custom-link-color' data-bind=\"click: access\">\n                        ",{type:"translate",nodelist:["give access ",{type:"translateVariable",var_name:"band_name",nodelist:['<span class="hidden-access">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</span>"]},""]},"\n                    </button>\n                "]}]},"\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: state() === 'i' --\x3e\n                <button class='artists-grid-remove custom-link-color' data-bind=\"click: uninvite\">\n                    ",{type:"translate",nodelist:["uninvite ",{type:"translateVariable",var_name:"band_name",nodelist:['<span class="hidden-access">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</span>"]},""]},"\n                </button>\n                <button class='artists-grid-reinvite custom-link-color' data-bind=\"click: reinvite\">\n                    ",{type:"translate",nodelist:["re-invite ",{type:"translateVariable",var_name:"band_name",nodelist:['<span class="hidden-access">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</span>"]},""]},"\n                </button>\n            \x3c!-- /ko --\x3e\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"!member_band.is_licensed_band_only ",attachment:["\n            \x3c!-- ko if: isHidden() --\x3e\n                <button class='artists-grid-unhide custom-link-color' data-bind=\"click: unhide\">\n                    ",{type:"translate",nodelist:["unhide ",{type:"translateVariable",var_name:"band_name",nodelist:['<span class="hidden-access">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</span>"]},""]},"\n                </button>\n            \x3c!-- /ko --\x3e\n            \x3c!-- ko if: !isHidden() --\x3e\n                <button class='artists-grid-hide custom-link-color' data-bind=\"click: hide\">\n                    ",{type:"translate",nodelist:["hide ",{type:"translateVariable",var_name:"band_name",nodelist:['<span class="hidden-access">',{type:"variable",name:"member_band.name",filters:[["h",[]]]},"</span>"]},""]},"\n                </button>\n            \x3c!-- /ko --\x3e\n            "]}]},"\n        </div>\n    "]}]},"\n</li>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/transfer_artist.liquid","warn"):Templ.register({"label/transfer_artist":['<form id="transfer-artist-dialog" class="modern-form">\n\n    <p>',{type:"translate",nodelist:["You’re about to remove ",{type:"translateVariable",var_name:"band_name",nodelist:["<em data-bind='text: memberBand.name'>the band</em>"]}," from ",{type:"translateVariable",var_name:"label_name",nodelist:["<em data-bind='text: gridVM.name'>the label</em>"]},"."]},"</p>\n\n    \x3c!-- ko with: memberBand.transferRequest --\x3e\n        <p>",{type:"translate",nodelist:["This will cancel the outstanding account transfer invitation to ",{type:"translateVariable",var_name:"recipient",nodelist:["<em data-bind='text: recipient_email'></em>"]},"."]},"</p>\n    \x3c!-- /ko --\x3e\n\n    <p>",{type:"translate",nodelist:["Please enter the email address of the person you’d like to transfer the account of ",{type:"translateVariable",var_name:"band_name",nodelist:["<em data-bind='text: memberBand.name'>the band</em>"]}," over to:"]},"</p>\n    \n    <label class='field-wrapper'>\n        <span class='title'>",{type:"translate",nodelist:["Email address"]},"</span>\n        <span class='field'>\n            <input type='email' data-bind='value: email1, valueUpdate: \"input\"' />\n        </span>\n        <p class='error' data-bind='animateText: email1.error_msg, animationType: \"slide\"'></p>\n    </label>\n\n    <label class='field-wrapper'>\n        <span class='title'>",{type:"translate",nodelist:["Confirm email address"]},"</span>\n        <span class='field' data-bind='css: {mismatch: emailMismatch()}'>\n            <input type='email' data-bind='value: email2, valueUpdate: \"input\"' />\n        </span>\n    </label>\n\n    <div class=\"buttons\">\n        <button data-bind=\"click: submit, disable: submitXhr() || emailMismatch()\">\n            \x3c!-- ko if: submitXhr --\x3e",{type:"translate",nodelist:["Please wait…"]},"\x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: submitXhr --\x3e",{type:"translate",nodelist:["OK"]},'\x3c!-- /ko --\x3e\n        </button><button data-bind="click: cancel, disable: submitXhr" class="weak">\n            ',{type:"translate",nodelist:["Cancel"]},"\n        </button>\n    </div>\n\n    \x3c!-- ko if: showProfileURL --\x3e\n    <p><br>",{type:"translate",nodelist:["Or you may delete this account via the artist’s <a ",{type:"translateVariable",var_name:"href",nodelist:['data-bind="attr: { href: profileURL }"']},">profile page</a>."]},"</p>\n    \x3c!-- /ko --\x3e\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/give_access.liquid","warn"):Templ.register({"label/give_access":['<form id="give-access-dialog" class="modern-form">\n\n    <p>',{type:"translate",nodelist:["You’re about to give another user access to ",{type:"translateVariable",var_name:"band_name",nodelist:["<em data-bind='text: memberBand.name'>the band</em>"]},"."]},"</p>\n\n    <p>",{type:"translate",nodelist:["Please enter the email address of the person you’d like to grant access to:"]},"</p>\n    \n    <label class='field-wrapper'>\n        <span class='title'>",{type:"translate",nodelist:["Email address"]},"</span>\n        <span class='field'>\n            <input type='email' data-bind='value: email1, valueUpdate: \"input\"' />\n        </span>\n        <p class='error' data-bind='animateText: email1.error_msg, animationType: \"slide\"'></p>\n    </label>\n\n    <label class='field-wrapper'>\n        <span class='title'>",{type:"translate",nodelist:["Confirm email address"]},"</span>\n        <span class='field' data-bind='css: {mismatch: emailMismatch()}'>\n            <input type='email' data-bind='value: email2, valueUpdate: \"input\"' />\n        </span>\n    </label>\n\n    <div class=\"buttons\">\n        <button data-bind=\"click: submit, disable: submitXhr() || emailMismatch()\">\n            \x3c!-- ko if: submitXhr --\x3e",{type:"translate",nodelist:["Please wait..."]},"\x3c!-- /ko --\x3e\n            \x3c!-- ko ifnot: submitXhr --\x3e",{type:"translate",nodelist:["OK"]},'\x3c!-- /ko --\x3e\n        </button><button data-bind="click: cancel, disable: submitXhr" class="weak">\n            ',{type:"translate",nodelist:["Cancel"]},"\n        </button>\n    </div>\n\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/add_item_dialog.liquid","warn"):Templ.register({"label/add_item_dialog":["\x3c!-- ko if: explanation --\x3e\n<div class='explanation' data-bind='text: explanation'></div>\n\x3c!-- /ko --\x3e\n<label>\n    <input type='radio' name='label-add-item-radio' value='label' data-bind='checked: labelBandRadioValue'>\n    <div class='label'>\n        <span data-bind='text: strAddToLabelAccount'></span>\n        \x3c!-- ko if: labelHint --\x3e\n        <div class='label-hint' data-bind='text: labelHint'></div>\n        \x3c!-- /ko --\x3e\n    </div>\n</label>\n<label>\n    <input type='radio' name='label-add-item-radio' value='band' data-bind='checked: labelBandRadioValue, enable: memberBands.length > 0'>\n    <div class='label'>\n        \x3c!-- ko if: memberBands.length > 0 --\x3e\n            <span data-bind='text: strAddToExistingArtistAccount'></span>\n        \x3c!-- /ko --\x3e\n    </div>\n    \x3c!-- ko if: memberBands.length === 0 --\x3e\n        \n        ",{type:"case",blocks:[{type:"condition",left:"item_type",right:"'album'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You can also add album to an artist account once you <a ",{type:"translateVariable",var_name:"new_artist_link",nodelist:["data-bind='click: addNewArtist' tabindex='0'"]},">create a new artist</a> or <a ",{type:"translateVariable",var_name:"existing_artist_link",nodelist:["data-bind='click: addExistingArtist' tabindex='0'"]},">add an existing artist</a>."]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"item_type",right:"'track'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You can also add track to an artist account once you <a ",{type:"translateVariable",var_name:"new_artist_link",nodelist:["data-bind='click: addNewArtist' tabindex='0'"]},">create a new artist</a> or <a ",{type:"translateVariable",var_name:"existing_artist_link",nodelist:["data-bind='click: addExistingArtist' tabindex='0'"]},">add an existing artist</a>."]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"item_type",right:"'merch'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You can also add merch to an artist account once you <a ",{type:"translateVariable",var_name:"new_artist_link",nodelist:["data-bind='click: addNewArtist' tabindex='0'"]},">create a new artist</a> or <a ",{type:"translateVariable",var_name:"existing_artist_link",nodelist:["data-bind='click: addExistingArtist' tabindex='0'"]},">add an existing artist</a>."]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"item_type",right:"'live_event'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You can also add live event to an artist account once you <a ",{type:"translateVariable",var_name:"new_artist_link",nodelist:["data-bind='click: addNewArtist' tabindex='0'"]},">create a new artist</a> or <a ",{type:"translateVariable",var_name:"existing_artist_link",nodelist:["data-bind='click: addExistingArtist' tabindex='0'"]},">add an existing artist</a>."]},"\n            "],child_relation:null,child_condition:null},{type:"condition",left:"item_type",right:"'listening_party'",operator:"==",attachment:["\n                ",{type:"translate",nodelist:["You can also add listening party to an artist account once you <a ",{type:"translateVariable",var_name:"new_artist_link",nodelist:["data-bind='click: addNewArtist' tabindex='0'"]},">create a new artist</a> or <a ",{type:"translateVariable",var_name:"existing_artist_link",nodelist:["data-bind='click: addExistingArtist' tabindex='0'"]},">add an existing artist</a>."]},"\n        "],child_relation:null,child_condition:null}]},"\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: memberBands.length === 1 --\x3e\n        <span class='band-name' data-bind='text: selectedBand().name'></span>\n    \x3c!-- /ko --\x3e\n</label>\n<span>\n    \x3c!-- ko if: memberBands.length > 1 --\x3e\n        <select data-bind='options: memberBands, optionsText: \"name\", value: selectedBand, click: bandSelectClick'></select>\n    \x3c!-- /ko --\x3e\n</span>\n\n\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/bulk_edit_price_dialog.liquid","warn"):Templ.register({"label/bulk_edit_price_dialog":['<label>pricing: </label><input type="text" data-bind="value: bulkPrice, css: {\'multi-price\': bulkPrice() == \'multiple\', \'error\': showErrors() && bulkPriceError()}, event: {keydown: clear}"></input> <span class="currency" data-bind="text: currency"></span><br>\n<span class="error-message" data-bind="visible: showErrors(), text: bulkPriceError"></span>\n<span class="hint" data-bind="text: priceHint"></span><br>\n<span class="pay-more"><input type="checkbox" data-bind="checked: payMore" indeterminate></input><span> ',{type:"translate",nodelist:["let fans pay more if they want"]},'</span></span>\n<hr/>\n<div class="ui-dialog-buttonset">\n    <button type="button" data-bind="click: bulkEdit">',{type:"translate",nodelist:["Edit ",{type:"translateVariable",var_name:"count",nodelist:['<span data-bind="text: itemsCount"></span>']}," items"]},'</button>\n    <button type="button" class="weak" data-bind="click: close">',{type:"translate",nodelist:["Cancel Edit"]},"</button>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/bulk_edit_shipping_dialog.liquid","warn"):Templ.register({"label/bulk_edit_shipping_dialog":['\x3c!-- ko foreach: origins --\x3e\n<div class="origin-shippings">\n    \x3c!-- ko foreach: destinations --\x3e\n    <div class="shipping-destination">\n        <p data-bind="text: description"></p>\n        ',{type:"translate",nodelist:["",{type:"translateVariable",var_name:"price",nodelist:['<input type="text" data-bind="value: price, css: {\'multi-price\': price() == \'multiple\'}, event: {keydown: clear}"></input> <span data-bind="text: $parent.currencySymbol"></span>']}," for 1 unit"]},"\n        ",{type:"translate",nodelist:["",{type:"translateVariable",var_name:"price",nodelist:['<input type="text" data-bind="value: increment, css: {\'multi-price\': increment() == \'multiple\'}, event: {keydown: clearIncrement}"></input> <span data-bind="text: $parent.currencySymbol"></span>']}," more per additional unit"]},'\n        <span class="error-message" data-bind="visible: $parent.showErrors() && priceError(), text: priceError"></span>\n        <span class="error-message" data-bind="visible: $parent.showErrors() && incrementError(), text: incrementError"></span>\n    </div>\n    \x3c!-- /ko --\x3e\n    <hr>\n</div>\n\x3c!-- /ko --\x3e\n<div class="ui-dialog-buttonset">\n    <button type="button" data-bind="click: bulkEdit, css: {\'dis\': !is_dirty()}">',{type:"translate",nodelist:["Edit ",{type:"translateVariable",var_name:"count",nodelist:['<span data-bind="text: itemsCount"></span>']}," items"]},'</button>\n    <button type="button" class="weak" data-bind="click: close">',{type:"translate",nodelist:["Cancel Edit"]},"</button>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/bulk_assign_owner_dialog.liquid","warn"):Templ.register({"label/bulk_assign_owner_dialog":[{type:"translate",nodelist:["Payments for these items go to ",{type:"translateVariable",var_name:"owner_name",nodelist:['<span class="owner-name" data-bind="text: currentOwnerText"></span>']}," via PayPal."]},'\n<div class="owner-transfer" data-bind="css: {\'dis\': !transferOwnership()}">\n    <input type="checkbox" data-bind="checked: transferOwnership"></input>\n    <div class="assign-text" data-bind="click: toggleTransferOwnership">\n        ',{type:"translate",nodelist:["Assign payment for these ",{type:"translateVariable",var_name:"count",nodelist:['<span data-bind="text: itemsCount"></span>']}," items to ",{type:"translateVariable",var_name:"owner_name",nodelist:["<span data-bind=\"text: potentialOwnerText, css: {'owner-name': potentialOwnerId}\"></span>"]},""]},'\n    </div>\n</div>\n<p data-bind="visible: !potentialOwnerId">',{type:"translate",nodelist:["Once you save you will return ownership to each artist and stop receiving payments from sales of these items. You may no longer be able to make edits and the items will not appear in your discography."]},'</p>\n<p data-bind="visible: potentialOwnerId">',{type:"translate",nodelist:["If this is not your correct PayPal address, please visit your <a ",{type:"translateVariable",var_name:"profile_href",nodelist:['target="_blank" data-bind="attr: {href: profileUrl}"']},">Profile page</a> to change it. If you do not yet have a PayPal account, kindly follow <a ",{type:"translateVariable",var_name:"payment_href",nodelist:['target="_blank" href="',{type:"variable",name:"siteroot_current",filters:[]},'/payment_setup"']},">these instructions</a> to set one up."]},'</p>\n<hr>\n<div class="ui-dialog-buttonset">\n    <button type="button" data-bind="click: bulkEdit, css: {\'dis\': !transferOwnership()}">',{type:"translate",nodelist:["Edit ",{type:"translateVariable",var_name:"count",nodelist:['<span data-bind="text: itemsCount"></span>']}," items"]},'</button>\n    <button type="button" class="weak" data-bind="click: close">',{type:"translate",nodelist:["Cancel Edit"]},"</button>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/_custom_header.liquid","warn"):Templ.register({_custom_header:["\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"customHeaderURL ",attachment:["\n    ",{type:"capture",to:"desktop_image_src",nodelist:['src="',{type:"variable",name:"customHeaderURL",filters:[["a",[]]]},'"']},"\n"]},{type:"ncondition",expression:"mband && mband.header_desktop && mband.header_desktop.image_id ",attachment:["\n    ",{type:"capture",to:"desktop_image_src",nodelist:[{type:"variable",name:"mband.header_desktop",filters:[["image",['"custom_header_desktop"']]]}]},"\n"]},{type:"else_ncondition",attachment:["\n    ",{type:"let",variable:"desktop_image_src",expression:"nil "},"\n"]}]},"\n\n",{type:"capture",to:"phone_image_url",nodelist:[{type:"variable",name:"mband.header_phone.image_id",filters:[["image_url",['"custom_header_phone"']]]}]},"\n",{type:"let",variable:"phone_image_url",expression:"mband.header_phone.image_id && phone_image_url "},"\n",{type:"let",variable:"area_tags",expression:"area_tags || (mband.header_desktop.using_map && mband.header_desktop.area_tags) "},"\n",{type:"let",variable:"default_link_url",expression:"custom_header_default_link_url || band.trackpipe_request_url || '/' "},"\n",{type:"let",variable:"desktop_link_url",expression:"!area_tags && standard_page && (mband.header_desktop.url || default_link_url) "},"\n",{type:"let",variable:"is_label",expression:"mband.is_label || is_label "},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"desktop_image_src && area_tags ",attachment:['\n<map name="_bc_customheader_map" id="_bc_customheader_map">\n    ',{type:"for",collection_name:"area_tags",nodelist:["\n    <area shape='",{type:"variable",name:"area_tag.shape",filters:[["a",[]]]},"' coords='",{type:"variable",name:"area_tag.coords",filters:[["a",[]]]},"' href='",{type:"variable",name:"area_tag.href",filters:[["a",[]]]},"' \n        ",{type:"ef",blocks:[{type:"ncondition",expression:"area_tag.alt ",attachment:[" alt='",{type:"variable",name:"area_tag.alt",filters:[["a",[]]]},"'"]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"area_tag.target ",attachment:[" target='",{type:"variable",name:"area_tag.target",filters:[["a",[]]]},"'"]}]},"\n        ",{type:"ef",blocks:[{type:"ncondition",expression:"area_tag.title ",attachment:[" title='",{type:"variable",name:"area_tag.title",filters:[["a",[]]]},"'"]}]},'\n        referrerpolicy="strict-origin-when-cross-origin"\n    >\n    '],variable_name:"area_tag",reversed:null,attribs:{}},"\n</map>\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"desktop_image_src || (phone_image_url) ",attachment:['\n    <div id="customHeader">\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"desktop_image_src ",attachment:['\n        <div class="desktop-header">\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"desktop_link_url ",attachment:['<a href="',{type:"variable",name:"desktop_link_url",filters:[["a",[]]]},'" referrerpolicy="strict-origin-when-cross-origin">']}]},"<img ",{type:"variable",name:"desktop_image_src",filters:[]},{type:"ef",blocks:[{type:"ncondition",expression:"area_tags ",attachment:[' usemap="#_bc_customheader_map"']}]},">",{type:"ef",blocks:[{type:"ncondition",expression:"desktop_link_url ",attachment:["</a>"]}]},"\n            ",{type:"ef",blocks:[{type:"ncondition",expression:"member_of_current_band && !custom_header_no_edit ",attachment:['\n            <button class="remove bandmember-only" type="button">X</button>\n            ']}]},"\n        </div>\n    "]}]},"\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"phone_image_url && !cfg.band_navbar_update_2023 ",attachment:['\n        <div class="phone-header">\n            <a href="',{type:"variable",name:"default_link_url",filters:[["a",[]]]},'" referrerpolicy="strict-origin-when-cross-origin"><img src="',{type:"variable",name:"phone_image_url",filters:[["a",[]]]},'"></a>\n        </div>\n    ']}]},"\n    </div>\n"]}]},"\n\n",{type:"ef",blocks:[{type:"ncondition",expression:"!desktop_image_src && member_of_current_band && !custom_header_no_edit ",attachment:['\n<div id="customHeaderBlank" class="\n    bandmember-only\n    custom-header-upload\n    ',{type:"ef",blocks:[{type:"ncondition",expression:"is_label ",attachment:["label-custom-header-upload"]}]},'\n">\n    <span id="chUploadButtonAndHint" class="upload-button-and-hint">\n        <button class="upload" type="button"><div>\n            ',{type:"ef",blocks:[{type:"ncondition",expression:"is_label ",attachment:["\n                ",{type:"ef",blocks:[{type:"ncondition",expression:"mband.name ",attachment:["\n                    ",{type:"translate",nodelist:["Upload custom header for ",{type:"translateVariable",var_name:"band_name",nodelist:[{type:"variable",name:"mband.name",filters:[["h",[]]]}]},""]},"\n                "]},{type:"else_ncondition",attachment:["\n                    ",{type:"translate",nodelist:["Upload custom header"]},"\n                "]}]},"\n            "]},{type:"else_ncondition",attachment:["\n                ",{type:"translate",nodelist:["Upload Custom Header"]},"\n            "]}]},'\n        </div></button>\n        <div id="headerDimensionsHint">',{type:"translate",nodelist:["975 pixels wide, 40-180 pixels tall, .jpg, .gif or .png, 2mb max"]},'</div>\n    </span>\n    <span id="chUploadProgressWrapper">\n        <div id="chUploadingLabel">',{type:"translate",nodelist:["Uploading ",{type:"translateVariable",var_name:"filename",nodelist:['<span class="filename">image</span>']},"..."]},'</div>\n        <div id="headerUploadProgress" class="upload-progress"></div>\n    </span>\n</div>\n']}]},"\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/_edit_design.liquid","warn"):Templ.register({_edit_design:['<form id="editDesign" action="">\n\n    <div id="picker" style="float:left;"></div>\n\n    <div class="form-item"><label for="bodyColor">',{type:"translate",nodelist:["Body Color:"]},' </label><span id="bodyColorSwatch" class="colorSwatch" style="border-color:',{type:"variable",name:"body_color",filters:[["a",[]]]},'"><input type="text" id="bodyColor" class="hexInput" value="',{type:"variable",name:"body_color",filters:[["a",[]]]},'"/></span></div>\n    <div class=\'form-item alert\' id=\'bodyColor_alert\'></div>\n\n    <div class="form-item"><label for="textColor">',{type:"translate",nodelist:["Text Color:"]},' </label><span id="textColorSwatch" class="colorSwatch" style="border-color:',{type:"variable",name:"text_color",filters:[["a",[]]]},'"><input type="text" id="textColor" class="hexInput" value="',{type:"variable",name:"text_color",filters:[["a",[]]]},'"/></span></div>\n    <div class=\'form-item alert\' id=\'textColor_alert\'></div>\n\n    <div class="form-item">\n        <label for="secondaryTextColor">',{type:"translate",nodelist:["Secondary Text Color:"]},' </label>\n        <span id="secondaryTextColorSwatch" class="colorSwatch" style="border-color:',{type:"variable",name:"secondary_text_color",filters:[["a",[]]]},'">\n            <input type="text" id="secondaryTextColor" class="hexInput" value="',{type:"variable",name:"secondary_text_color",filters:[["a",[]]]},'"/></span></div>\n\n    <div class=\'form-item alert\' id=\'secondaryTextColor_alert\'></div>\n\n    <div class="form-item"><label for="linkColor">',{type:"translate",nodelist:["Link Color:"]},' </label><span id="linkColorSwatch" class="colorSwatch" style="border-color:',{type:"variable",name:"link_color",filters:[["a",[]]]},'"><input type="text" id="linkColor" class="hexInput" value="',{type:"variable",name:"link_color",filters:[["a",[]]]},'"/></span></div>\n    <div class=\'form-item alert\' id=\'linkColor_alert\'></div>\n\n    <div class="form-item"><label for="bgColor">',{type:"translate",nodelist:["Background Color:"]},' </label><span id="bgColorSwatch" class="colorSwatch" style="border-color:',{type:"variable",name:"bg_color",filters:[["a",[]]]},'"><input type="text" id="bgColor" class="hexInput" value="',{type:"variable",name:"bg_color",filters:[["a",[]]]},"\"/></span></div>\n    <div class='form-item alert' id='bgColor_alert'></div>\n\n    ",{type:"ef",blocks:[{type:"ncondition",expression:"navbar_visible ",attachment:['\n    <div class="form-item"><label for="navbarBgColor">',{type:"translate",nodelist:["Navigation Bar Color:"]},' </label><span id="navbarBgColorSwatch" class="colorSwatch" style="border-color:',{type:"variable",name:"navbar_bg_color",filters:[["a",[]]]},'"><input type="text" id="navbarBgColor" class="hexInput" value="',{type:"variable",name:"navbar_bg_color",filters:[["a",[]]]},'"/></span></div>\n    <div class="form-item alert" id="navbarBgColor_alert"></div>\n    ']}]},'\n\n    <div class="form-item"><a class="restore-default-colors">',{type:"translate",nodelist:["restore default colors"]},'</a></div>\n\n    <div id="bgImageControlsWrapper">\n        ',{type:"include",template_name:"'_bg_image_upload'"},"\n    </div>\n\n</form>\n"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/label/change_label_subscription_paypal.liquid","warn"):Templ.register({"label/change_label_subscription_paypal":['<div id="change-label-paypal-vm">\n    <p class="label-paypal-change-message">',{type:"translate",nodelist:["Changing your payment address requires that you check out through PayPal again using your new address. By proceeding, you will be charged the ",{type:"translateVariable",var_name:"price",nodelist:["<strong>",{type:"variable",name:"subscription_cost",filters:[["currency",["'USD'"]]]},"</strong>"]}," fee for next month’s subscription now, and you will not be charged again until ",{type:"translateVariable",var_name:"billing_date",nodelist:["<strong>",{type:"variable",name:"next_billing_date",filters:[["time",["'yyyyMMMMd'"]]]},"</strong>"]},"."]},'</p>\n    <p class="label-paypal-change-commands">\n        <a class="label-paypal-change" data-bind="click: goToPayPal">',{type:"translate",nodelist:["Let’s do this"]},'</a>\n        <a class="cancel-label-paypal-change" data-bind="click: cancel">',{type:"translate",nodelist:["Not right now"]},"</a>\n    </p>\n</div>"]}),void 0===window.Templ?Log.server("Premature template registration: trackpipe/template/_bg_image_upload.liquid","warn"):Templ.register({_bg_image_upload:['<div id="background-image-container" class="form-item">\n\n',{type:"if",blocks:[{type:"condition",left:"bg_image_id",right:null,operator:null,attachment:['\n    <div class="form-item">\n        <span style="white-space: nowrap">',{type:"translate",nodelist:["Background Image:"]},'</span>\n        <span style="white-space: nowrap">\n            <span id="bg-image-filename" title="',{type:"variable",name:"bg_file_name",filters:[["a",[]]]},'">',{type:"variable",name:"bg_file_name",filters:[["h",[]]]},'</span>\n            <a id="bg-image-delete">',{type:"translate",nodelist:["delete"]},'</a>\n        </span>\n    </div>\n    <div class="form-item">\n        <label>',{type:"translate",nodelist:["Background Behavior:"]},'\n            <select id="bg-behavior">\n                <option value="r"',{type:"ef",blocks:[{type:"ncondition",expression:'bg_behavior == "r" ',attachment:[" selected"]}]},">",{type:"translate",nodelist:["Default"]},'</option>\n                <option value="f"',{type:"ef",blocks:[{type:"ncondition",expression:'bg_behavior == "f" ',attachment:[" selected"]}]},">",{type:"translate",nodelist:["Fill"]},'</option>\n            </select>\n        </label>\n    </div>\n    <div id="repeat-behavior-items">\n        <div class="form-item">',{type:"translate",nodelist:["Repeat:"]},'\n            <div>\n                <label><input type="checkbox" id="bg-hrepeat"',{type:"ef",blocks:[{type:"ncondition",expression:"tile_bg == 1 || tile_bg == 2 ",attachment:[" checked"]}]},' value="1"> ',{type:"translate",nodelist:["Horizontally"]},'</label>\n                <label><input type="checkbox" id="bg-vrepeat"',{type:"ef",blocks:[{type:"ncondition",expression:"tile_bg == 1 || tile_bg == 3 ",attachment:[" checked"]}]},' value="1"> ',{type:"translate",nodelist:["Vertically"]},'</label>\n            </div>\n        </div>\n        <div class="form-item">\n            <label>',{type:"translate",nodelist:["Align:"]},'\n                <select id="bg-halign">\n                    <option value="l"',{type:"ef",blocks:[{type:"ncondition",expression:'bg_halign == "l" ',attachment:[" selected"]}]},">",{type:"translate",nodelist:["Left"]},'</option>\n                    <option value="c"',{type:"ef",blocks:[{type:"ncondition",expression:'bg_halign == "c" ',attachment:[" selected"]}]},">",{type:"translate",nodelist:["Center"]},'</option>\n                    <option value="r"',{type:"ef",blocks:[{type:"ncondition",expression:'bg_halign == "r" ',attachment:[" selected"]}]},">",{type:"translate",nodelist:["Right"]},'</option>\n                </select>\n            </label>\n        </div>\n        <div class="form-item">',{type:"translate",nodelist:["Position:"]},'\n            <label><input type="checkbox" id="bg-fixed" ',{type:"ef",blocks:[{type:"ncondition",expression:"bg_fixed ",attachment:[" checked"]}]},' value="1"> ',{type:"translate",nodelist:["Fixed"]},"</label>\n        </div>\n    </div>\n"],child_relation:null,child_condition:null},{type:"else_condition",attachment:['\n    <div class="form-item">\n        <span style="white-space: nowrap">',{type:"translate",nodelist:["Background Image:"]},'</span>\n        <div class="upload-controls-wrapper">\n            <a id="design-bg-image-upload-button">',{type:"translate",nodelist:["upload"]},'</a>\n            <div id="bg-image-upload-hint">',{type:"translate",nodelist:[".jpg, .gif, .png, 2mb max"]},'</div>\n        </div>\n        <div class="upload-progress-wrapper">\n            <span class="upload-progress"></span>\n        </div>\n    </div>\n']}]},"\n\n</div>"]}),jQuery.fn.farbtastic=function(e){return $.farbtastic(this,e),this},jQuery.farbtastic=function(e,t){return(e=$(e).get(0)).farbtastic||(e.farbtastic=new jQuery._farbtastic(e,t))},jQuery._farbtastic=function(e,t){var a=this;$(e).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var n=$(".farbtastic",e);a.wheel=$(".wheel",e).get(0),a.radius=84,a.square=100,a.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&$("*",n).each((function(){if("none"!=this.currentStyle.backgroundImage){var e=this.currentStyle.backgroundImage;e=this.currentStyle.backgroundImage.substring(5,e.length-2),$(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+e+"')"})}})),a.linkTo=function(e){return"object"==typeof a.callback&&$(a.callback).unbind("keyup",a.updateValue),a.color=null,"function"==typeof e?a.callback=e:"object"!=typeof e&&"string"!=typeof e||(a.callback=$(e),a.callback.bind("keyup",a.updateValue),a.callback.get(0).value&&a.setColor(a.callback.get(0).value)),this},a.updateValue=function(e){this.value&&this.value!=a.color&&a.setColor(this.value)},a.setColor=function(e){var t=a.unpack(e);return a.color!=e&&t&&(a.color=e,a.rgb=t,a.hsl=a.RGBToHSL(a.rgb),a.updateDisplay()),this},a.setHSL=function(e){return a.hsl=e,a.rgb=a.HSLToRGB(e),a.color=a.pack(a.rgb),a.updateDisplay(),this},a.widgetCoords=function(e){var t,n,i=e.target||e.srcElement,o=a.wheel;if(void 0!==e.offsetX){for(var s={x:e.offsetX,y:e.offsetY},r=i;r;)r.mouseX=s.x,r.mouseY=s.y,s.x+=r.offsetLeft,s.y+=r.offsetTop,r=r.offsetParent;r=o;for(var l={x:0,y:0};r;){if(void 0!==r.mouseX){t=r.mouseX-l.x,n=r.mouseY-l.y;break}l.x+=r.offsetLeft,l.y+=r.offsetTop,r=r.offsetParent}for(r=i;r;)r.mouseX=void 0,r.mouseY=void 0,r=r.offsetParent}else{s=a.absolutePosition(o);t=(e.pageX||0*(e.clientX+$("html").get(0).scrollLeft))-s.x,n=(e.pageY||0*(e.clientY+$("html").get(0).scrollTop))-s.y}return{x:t-a.width/2,y:n-a.width/2}},a.mousedown=function(e){document.dragging||($(document).bind("mousemove",a.mousemove).bind("mouseup",a.mouseup),document.dragging=!0);var t=a.widgetCoords(e);return a.circleDrag=2*Math.max(Math.abs(t.x),Math.abs(t.y))>a.square,a.mousemove(e),!1},a.mousemove=function(e){var t=a.widgetCoords(e);if(a.circleDrag){var n=Math.atan2(t.x,-t.y)/6.28;n<0&&(n+=1),a.setHSL([n,a.hsl[1],a.hsl[2]])}else{var i=Math.max(0,Math.min(1,-t.x/a.square+.5)),o=Math.max(0,Math.min(1,-t.y/a.square+.5));a.setHSL([a.hsl[0],i,o])}return!1},a.mouseup=function(){$(document).unbind("mousemove",a.mousemove),$(document).unbind("mouseup",a.mouseup),document.dragging=!1},a.updateDisplay=function(){var e=6.28*a.hsl[0];$(".h-marker",n).css({left:Math.round(Math.sin(e)*a.radius+a.width/2)+"px",top:Math.round(-Math.cos(e)*a.radius+a.width/2)+"px"}),$(".sl-marker",n).css({left:Math.round(a.square*(.5-a.hsl[1])+a.width/2)+"px",top:Math.round(a.square*(.5-a.hsl[2])+a.width/2)+"px"}),$(".color",n).css("backgroundColor",a.pack(a.HSLToRGB([a.hsl[0],1,.5]))),"object"==typeof a.callback?($(a.callback).css({backgroundColor:a.color,color:a.hsl[2]>.5?"#000":"#fff"}),$(a.callback).each((function(){this.value&&this.value!=a.color&&(this.value=a.color)}))):"function"==typeof a.callback&&a.callback.call(a,a.color)},a.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop};if(e.offsetParent){var n=a.absolutePosition(e.offsetParent);t.x+=n.x,t.y+=n.y}return t},a.pack=function(e){var t=Math.round(255*e[0]),a=Math.round(255*e[1]),n=Math.round(255*e[2]);return"#"+(t<16?"0":"")+t.toString(16)+(a<16?"0":"")+a.toString(16)+(n<16?"0":"")+n.toString(16)},a.unpack=function(e){return 7==e.length?[parseInt("0x"+e.substring(1,3))/255,parseInt("0x"+e.substring(3,5))/255,parseInt("0x"+e.substring(5,7))/255]:4==e.length?[parseInt("0x"+e.substring(1,2))/15,parseInt("0x"+e.substring(2,3))/15,parseInt("0x"+e.substring(3,4))/15]:void 0},a.HSLToRGB=function(e){var t,a,n=e[0],i=e[1],o=e[2];return t=2*o-(a=o<=.5?o*(i+1):o+i-o*i),[this.hueToRGB(t,a,n+.33333),this.hueToRGB(t,a,n),this.hueToRGB(t,a,n-.33333)]},a.hueToRGB=function(e,t,a){return 6*(a=a<0?a+1:a>1?a-1:a)<1?e+(t-e)*a*6:2*a<1?t:3*a<2?e+(t-e)*(.66666-a)*6:e},a.RGBToHSL=function(e){var t,a,n,i,o,s,r=e[0],l=e[1],d=e[2];return t=Math.min(r,Math.min(l,d)),n=(a=Math.max(r,Math.max(l,d)))-t,o=0,(s=(t+a)/2)>0&&s<1&&(o=n/(s<.5?2*s:2-2*s)),i=0,n>0&&(a==r&&a!=l&&(i+=(l-d)/n),a==l&&a!=d&&(i+=2+(d-r)/n),a==d&&a!=r&&(i+=4+(r-l)/n),i/=6),[i,o,s]},$("*",n).mousedown(a.mousedown),a.setColor("#000000"),t&&a.linkTo(t)},function(e){"use strict";e.widget("bc.bctaginput",e.ui.autocomplete,{options:{minLength:3,delay:500,tagList:null,tagInput:null,endpoint:"/tag_ac",source:function(t,a){const n=this;e.ajax({url:n.options.endpoint,type:"GET",data:{term:t.term},success:function(e){n.filterResults.apply(n,[e,a])},error:function(){a([])}})}},_create:function(){const t=this;Iter.each(["tagList","tagInput"],(function(e){if(null===t[e])return Log.debug("[bctaginput] Missing "+e+" parameter"),!1})),this._super(),this._on(this.element,{keydown:function(a){const n=[e.ui.keyCode.ENTER,e.ui.keyCode.NUMPAD_ENTER,e.ui.keyCode.COMMA];if(-1!==e.inArray(a.keyCode,n)){const n=t.options.tagInput().toLowerCase().split("/");e.each(n,(function(e,a){t.addTag(a)})),t.close(),a.preventDefault()}},blur:function(){t.addTag(t.options.tagInput().toLowerCase()),t.close()}}),this.options.select=function(e,a){t.addTag(a.item.value),e.preventDefault()}},addTag:function(t){t&&""!==t&&(t=t.replace(/(^|,)\s*#+/g,"$1 "),-1===e.inArray(t,this.options.tagList())&&this.options.tagList.push(t),this.options.tagInput(""))},filterResults:function(t,a){const n=this;let i;t.matches?(i=Iter.collect(t.matches,(function(e){return e.name.toLowerCase()})),i=Iter.findAll(i,(function(t){return-1===e.inArray(t,n.options.tagList())})),a(i)):a([])}})}(jQuery),function(){"use strict";$(document).ready((function(){$("a.new","#add-artist-buttons").click((function(e){e.preventDefault(),AddNewArtistDialog.showDialog()})),$("a.existing","#add-artist-buttons").click((function(e){e.preventDefault(),AddExistingArtistDialog.showDialog()}))}))}();
